

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png">
  <link rel="icon" href="/img/favicon.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="CoolestEnoch">
  <meta name="keywords" content="">
  
    <meta name="description" content="TL;DRä»Šå¹´ä¸€å¼€å¹´ï¼ŒSurpriseï¼ipv4å®¶å®½å¼€æœå…¨å¯„ï¼è¶ç€è¿‡å¹´èµ°äº²æˆšçš„æ—¶å€™æ‹¿Natteræµ‹äº†ä¸€ä¸‹ï¼Œæˆ‘å®¶ã€äº²æˆšå®¶çš„ç½‘ç»œéƒ½æ˜¯NAT 4ç±»å‹çš„ã€‚å¥½ï¼Œå¥½ï¼Œå¤ªå¥½äº†ã€‚ å¼€å­¦å›æ ¡åï¼Œæ°é€¢æ ¡å›­ç½‘åŸºç¡€è®¾æ–½æ›´æ–°ï¼Œå¬é—¨å£å¤§çˆ·è¯´æ˜¯ä¸Šä¸ªå­¦æœŸæ¢çš„ä¸€æ‰¹ç½‘ç»œè®¾å¤‡åäº†è¿”å‚ç»´ä¿®ï¼Œå¼€å­¦è¿™æ®µæ—¶é—´åˆ°è´§å­¦æ ¡é‡Œã€‚æˆ‘è¯´å‘¢å›æ ¡ç¬¬ä¸€å¤©æ€ä¹ˆå®¿èˆé‡Œæ²¡WiFiä½†æ˜¯å›¾ä¹¦é¦†WiFiä¸€åˆ‡æ­£å¸¸ï¼Œè¿‡ä¸¤å¤©å°±æœ‰WiFiäº†è€Œä¸”è¿˜æ˜¯WiFi6ï¼å¤©ç¿¼3Gå¤ªå¿«è¾£ï¼ï¼">
<meta property="og:type" content="article">
<meta property="og:title" content="æŠ˜è…¾ä¸€ç•ªCloudFlare DDNS">
<meta property="og:url" content="http://blog.coolenoch.ink/2024/03/02/10%E6%8A%98%E8%85%BE%E4%B8%80%E7%95%AACloudFlare%20DDNS-240302/index.html">
<meta property="og:site_name" content="Enochçš„ä¸ªäººå°ç«™">
<meta property="og:description" content="TL;DRä»Šå¹´ä¸€å¼€å¹´ï¼ŒSurpriseï¼ipv4å®¶å®½å¼€æœå…¨å¯„ï¼è¶ç€è¿‡å¹´èµ°äº²æˆšçš„æ—¶å€™æ‹¿Natteræµ‹äº†ä¸€ä¸‹ï¼Œæˆ‘å®¶ã€äº²æˆšå®¶çš„ç½‘ç»œéƒ½æ˜¯NAT 4ç±»å‹çš„ã€‚å¥½ï¼Œå¥½ï¼Œå¤ªå¥½äº†ã€‚ å¼€å­¦å›æ ¡åï¼Œæ°é€¢æ ¡å›­ç½‘åŸºç¡€è®¾æ–½æ›´æ–°ï¼Œå¬é—¨å£å¤§çˆ·è¯´æ˜¯ä¸Šä¸ªå­¦æœŸæ¢çš„ä¸€æ‰¹ç½‘ç»œè®¾å¤‡åäº†è¿”å‚ç»´ä¿®ï¼Œå¼€å­¦è¿™æ®µæ—¶é—´åˆ°è´§å­¦æ ¡é‡Œã€‚æˆ‘è¯´å‘¢å›æ ¡ç¬¬ä¸€å¤©æ€ä¹ˆå®¿èˆé‡Œæ²¡WiFiä½†æ˜¯å›¾ä¹¦é¦†WiFiä¸€åˆ‡æ­£å¸¸ï¼Œè¿‡ä¸¤å¤©å°±æœ‰WiFiäº†è€Œä¸”è¿˜æ˜¯WiFi6ï¼å¤©ç¿¼3Gå¤ªå¿«è¾£ï¼ï¼">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://tse3-mm.cn.bing.net/th/id/OIP-C.UQu4ACZzLR3a2dAmE7iYyQHaEK?rs=1&pid=ImgDetMain">
<meta property="article:published_time" content="2024-03-02T10:00:00.000Z">
<meta property="article:modified_time" content="2024-06-30T14:33:47.817Z">
<meta property="article:author" content="CoolestEnoch">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://tse3-mm.cn.bing.net/th/id/OIP-C.UQu4ACZzLR3a2dAmE7iYyQHaEK?rs=1&pid=ImgDetMain">
  
  
  
  <title>æŠ˜è…¾ä¸€ç•ªCloudFlare DDNS - Enochçš„ä¸ªäººå°ç«™</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- ä¸»é¢˜ä¾èµ–çš„å›¾æ ‡åº“ï¼Œä¸è¦è‡ªè¡Œä¿®æ”¹ -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  



  
<link rel="stylesheet" href="/css/effect/cursor.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"blog.coolenoch.ink","root":"/","version":"1.9.7","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":true,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 7.2.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Enochçš„ä¸ªäººå°ç«™</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>é¦–é¡µ</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>å½’æ¡£</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>åˆ†ç±»</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>å…³äº</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/" target="_self">
                <i class="iconfont icon-link-fill"></i>
                <span>å‹é“¾</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/airplane.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="æŠ˜è…¾ä¸€ç•ªCloudFlare DDNS"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2024-03-02 18:00" pubdate>
          2024å¹´3æœˆ2æ—¥ æ™šä¸Š
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          9.4k å­—
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          79 åˆ†é’Ÿ
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">æŠ˜è…¾ä¸€ç•ªCloudFlare DDNS</h1>
            
            
              <div class="markdown-body">
                
                <p><img src="https://tse3-mm.cn.bing.net/th/id/OIP-C.UQu4ACZzLR3a2dAmE7iYyQHaEK?rs=1&pid=ImgDetMain" srcset="/img/loading.gif" lazyload alt="å°é¢"></p>
<h1 id="TL-DR"><a href="#TL-DR" class="headerlink" title="TL;DR"></a>TL;DR</h1><p>ä»Šå¹´ä¸€å¼€å¹´ï¼ŒSurpriseï¼ipv4å®¶å®½å¼€æœå…¨å¯„ï¼<br>è¶ç€è¿‡å¹´èµ°äº²æˆšçš„æ—¶å€™æ‹¿<a target="_blank" rel="noopener" href="https://github.com/MikeWang000000/Natter">Natter</a>æµ‹äº†ä¸€ä¸‹ï¼Œæˆ‘å®¶ã€äº²æˆšå®¶çš„ç½‘ç»œéƒ½æ˜¯<code>NAT 4</code>ç±»å‹çš„ã€‚å¥½ï¼Œå¥½ï¼Œå¤ªå¥½äº†ã€‚</p>
<p>å¼€å­¦å›æ ¡åï¼Œæ°é€¢æ ¡å›­ç½‘åŸºç¡€è®¾æ–½æ›´æ–°ï¼Œå¬é—¨å£å¤§çˆ·è¯´æ˜¯ä¸Šä¸ªå­¦æœŸæ¢çš„ä¸€æ‰¹ç½‘ç»œè®¾å¤‡åäº†è¿”å‚ç»´ä¿®ï¼Œå¼€å­¦è¿™æ®µæ—¶é—´åˆ°è´§å­¦æ ¡é‡Œã€‚<br>æˆ‘è¯´å‘¢å›æ ¡ç¬¬ä¸€å¤©æ€ä¹ˆå®¿èˆé‡Œæ²¡WiFiä½†æ˜¯å›¾ä¹¦é¦†WiFiä¸€åˆ‡æ­£å¸¸ï¼Œè¿‡ä¸¤å¤©å°±æœ‰WiFiäº†<em><strong>è€Œä¸”è¿˜æ˜¯WiFi6ï¼</strong></em><del><em>å¤©ç¿¼3Gå¤ªå¿«è¾£ï¼ï¼ï¼</em></del><br>ç»§ç»­æ‹¿<code>Natter</code>æµ‹äº†ä¸€ä¸‹ï¼Œè¿˜æ˜¯<code>NAT 4</code>ï¼ŒğŸ†—ã€‚<br>å‡ºå¯å®¤ä¹°é¥­è¿˜èƒ½çœ‹åˆ°å‡ ä¸ªæŠ€æœ¯å‘˜åœ¨ä¸€æ¥¼å¼€æŸœå­å¼„äº¤æ¢æœºï¼Œä¸è¿‡è¿™å‡ å¤©ä¼¼ä¹æ²¡åŠ¨é™äº†ï¼Œä½†æœ‰çº¿ç½‘å£è¿˜æ˜¯è·å–ä¸åˆ°ipåœ°å€ï¼Œ<del><em>æ‰€ä»¥æœ‰çº¿å®½å¸¦ä»€ä¹ˆæ—¶å€™æ¢å¤</em></del>ã€‚</p>
<h1 id="å‰æœŸæ¢ç´¢"><a href="#å‰æœŸæ¢ç´¢" class="headerlink" title="å‰æœŸæ¢ç´¢"></a>å‰æœŸæ¢ç´¢</h1><p>åœ¨ä¸Šä¸ªå­¦æœŸï¼ŒåŒå­¦é€æˆ‘äº†ä¸ª<del><em>ä¸­å›½ç”µä¿¡4Kè¶…é«˜æ¸…</em></del>æœºé¡¶ç›’ï¼ŒèŠ¯ç‰‡æ˜¯æ™¶æ™¨çš„<code>Amlogic S905X</code>ï¼Œå†…å­˜<code>1GB</code>ï¼Œ<del><em>å¤–å­˜</em></del>ç¡¬ç›˜<code>6Gb</code>ï¼Œåˆ·äº†ä¸ª<code>ArmBian</code>ç³»ç»Ÿã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs bash">    _    ____  __  __        __   _  _<br>   / \  |  _ \|  \/  |      / /_ | || |<br>  / _ \ | |_) | |\/| |_____| <span class="hljs-string">&#x27;_ \| || |_</span><br><span class="hljs-string"> / ___ \|  _ &lt;| |  | |_____| (_) |__   _|</span><br><span class="hljs-string">/_/   \_\_| \_\_|  |_|      \___/   |_|</span><br><span class="hljs-string"></span><br><span class="hljs-string">Welcome to Ubuntu 20.04.5 LTS with Linux 5.9.0-arm-64</span><br><span class="hljs-string"></span><br><span class="hljs-string">No end-user support: built from trunk</span><br><span class="hljs-string"></span><br><span class="hljs-string">System load:   3%               Up time:       2 min</span><br><span class="hljs-string">Memory usage:  14% of 924M      IP:            192.168.1.102</span><br><span class="hljs-string">CPU temp:      43Â°C             Usage of /:    30% of 5.8G</span><br><span class="hljs-string"></span><br><span class="hljs-string">Last login: Sun Feb 25 13:17:07 2024</span><br><span class="hljs-string">root@arm-64:~# neofetch</span><br><span class="hljs-string">                                 root@arm-64</span><br><span class="hljs-string">                                 -----------</span><br><span class="hljs-string">      â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ      OS: Armbian focal (20.10) aarch64</span><br><span class="hljs-string">     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     Host: Amlogic Meson GXL (S905X) P212 Development Board</span><br><span class="hljs-string">   â–„â–„â–ˆâ–ˆ                   â–ˆâ–ˆâ–„â–„   Kernel: 5.9.0-arm-64</span><br><span class="hljs-string">   â–„â–„â–ˆâ–ˆ    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    â–ˆâ–ˆâ–„â–„   Uptime: 2 mins</span><br><span class="hljs-string">   â–„â–„â–ˆâ–ˆ   â–ˆâ–ˆ         â–ˆâ–ˆ   â–ˆâ–ˆâ–„â–„   Packages: 515 (dpkg)</span><br><span class="hljs-string">   â–„â–„â–ˆâ–ˆ   â–ˆâ–ˆ         â–ˆâ–ˆ   â–ˆâ–ˆâ–„â–„   Shell: bash 5.0.17</span><br><span class="hljs-string">   â–„â–„â–ˆâ–ˆ   â–ˆâ–ˆ         â–ˆâ–ˆ   â–ˆâ–ˆâ–„â–„   Resolution: 720x576i</span><br><span class="hljs-string">   â–„â–„â–ˆâ–ˆ   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   â–ˆâ–ˆâ–„â–„   Terminal: /dev/pts/0</span><br><span class="hljs-string">   â–„â–„â–ˆâ–ˆ   â–ˆâ–ˆ         â–ˆâ–ˆ   â–ˆâ–ˆâ–„â–„   CPU: (4) @ 2.016GHz</span><br><span class="hljs-string">   â–„â–„â–ˆâ–ˆ   â–ˆâ–ˆ         â–ˆâ–ˆ   â–ˆâ–ˆâ–„â–„   Memory: 132MiB / 924MiB</span><br><span class="hljs-string">   â–„â–„â–ˆâ–ˆ   â–ˆâ–ˆ         â–ˆâ–ˆ   â–ˆâ–ˆâ–„â–„</span><br><span class="hljs-string">   â–„â–„â–ˆâ–ˆ                   â–ˆâ–ˆâ–„â–„</span><br><span class="hljs-string">     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ</span><br><span class="hljs-string">      â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ â–ˆ</span><br></code></pre></td></tr></table></figure>

<p>ä¸Šä¸ªå­¦æœŸæˆ‘æ‹¿å®ƒé…ç½®äº†ä¸€ä¸ª<code>FRP</code>è¿åˆ°æˆ‘å›½å†…å…¬ç½‘VPSï¼ŒæŠŠå¯å®¤ç¯å¢ƒæš´éœ²å‡ºå»ç„¶åæ–¹ä¾¿è¿œç¨‹åŠå…¬ã€‚å¤§æ¦‚ç»†èŠ‚æ˜¯ï¼Œè¿™å°<del><em>ä¸­å›½ç”µä¿¡4Kè¶…é«˜æ¸…</em></del>æœºé¡¶ç›’å……å½“è·³æ¿æœºï¼Œå¯å®¤è·¯ç”±å™¨åªå¼€æ”¾ä¸€ä¸ªç«¯å£ä¾›æˆ‘åœ¨å›¾ä¹¦é¦†é€šè¿‡æ ¡å›­å¤§å†…ç½‘è¿å›å¯å®¤è·³æ¿æœºï¼Œç„¶åè®¿é—®ä½äºå®¿èˆçš„ç”µè„‘ã€‚ä½†æ˜¯è¿™åªè§£å†³äº†æ ¡å†…çš„äº’è”ï¼Œè¿˜è¦å¤„ç†æ ¡å¤–å…¬ç½‘ç¯å¢ƒä»¥åŠå›å®¶åæ€ä¹ˆåŠã€‚äºæ˜¯æˆ‘åœ¨è·³æ¿æœºé‡Œéƒ¨ç½²äº†ä¸€ä¸ªä»£ç†è½¯ä»¶çš„æœåŠ¡ç«¯ï¼Œå¹¶åœ¨åå°ä½¿ç”¨<code>systemd</code>å¯¹å…¶è¿›è¡Œä¿æ´»ï¼Œå†ç”¨<code>ssh</code>çš„ç«¯å£æ˜ å°„å°†ä»£ç†è½¯ä»¶ç›‘å¬çš„tcpç«¯å£æ˜ å°„åˆ°å›½å†…å…¬ç½‘çš„VPSä¸Šã€‚äººåœ¨æ ¡å¤–ï¼Œé€šè¿‡æ‰‹æœºä¸Šæˆ–è€…<del><em>è‹è²</em></del>Surfaceä¸Šçš„ä»£ç†è½¯ä»¶è¿åˆ°å›½å†…å…¬ç½‘VPSçš„æ˜ å°„ç«¯å£ï¼Œè¿™ä¸ªæ—¶å€™æµé‡ä¼šå›åˆ°è·³æ¿æœºï¼Œå†è®¿é—®å†…ç½‘èµ„æºã€‚</p>
<p><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="599px" height="501px" viewBox="-0.5 -0.5 599 501" content="&lt;mxfile host=&quot;app.diagrams.net&quot; modified=&quot;2024-03-02T08:12:03.100Z&quot; agent=&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 &quot; etag=&quot;_iHpd9Tzzn-96WI1j-Py&quot; version=&quot;24.0.0&quot; type=&quot;device&quot;&gt;&#10;  &lt;diagram name=&quot;Page-1&quot; id=&quot;qOIfiBnbt-_uR34WX2cL&quot;&gt;&#10;    &lt;mxGraphModel dx=&quot;1050&quot; dy=&quot;564&quot; grid=&quot;1&quot; gridSize=&quot;10&quot; guides=&quot;1&quot; tooltips=&quot;1&quot; connect=&quot;1&quot; arrows=&quot;1&quot; fold=&quot;1&quot; page=&quot;1&quot; pageScale=&quot;1&quot; pageWidth=&quot;850&quot; pageHeight=&quot;1100&quot; math=&quot;0&quot; shadow=&quot;0&quot;&gt;&#10;      &lt;root&gt;&#10;        &lt;mxCell id=&quot;0&quot; /&gt;&#10;        &lt;mxCell id=&quot;1&quot; parent=&quot;0&quot; /&gt;&#10;        &lt;mxCell id=&quot;j0mtV--DJc_brgJgEW1E-40&quot; value=&quot;&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;54.5&quot; y=&quot;58&quot; width=&quot;595.5&quot; height=&quot;500&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;j0mtV--DJc_brgJgEW1E-2&quot; value=&quot;&quot; style=&quot;image;html=1;image=img/lib/clip_art/networking/Router_Icon_128x128.png&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;204&quot; y=&quot;320&quot; width=&quot;80&quot; height=&quot;80&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;j0mtV--DJc_brgJgEW1E-4&quot; value=&quot;&quot; style=&quot;shape=image;html=1;verticalAlign=top;verticalLabelPosition=bottom;labelBackgroundColor=#ffffff;imageAspect=0;aspect=fixed;image=https://cdn2.iconfinder.com/data/icons/boxicons-regular-vol-3/24/bx-server-128.png&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;64&quot; y=&quot;470&quot; width=&quot;48&quot; height=&quot;48&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;j0mtV--DJc_brgJgEW1E-5&quot; value=&quot;&quot; style=&quot;verticalLabelPosition=bottom;html=1;verticalAlign=top;align=center;strokeColor=none;fillColor=#00BEF2;shape=mxgraph.azure.laptop;pointerEvents=1;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;164&quot; y=&quot;473.5&quot; width=&quot;60&quot; height=&quot;41&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;j0mtV--DJc_brgJgEW1E-6&quot; value=&quot;&quot; style=&quot;sketch=0;pointerEvents=1;shadow=0;dashed=0;html=1;strokeColor=none;fillColor=#505050;labelPosition=center;verticalLabelPosition=bottom;verticalAlign=top;outlineConnect=0;align=center;shape=mxgraph.office.devices.tablet_ipad;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;274&quot; y=&quot;468&quot; width=&quot;39&quot; height=&quot;52&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;j0mtV--DJc_brgJgEW1E-7&quot; value=&quot;&quot; style=&quot;image;aspect=fixed;perimeter=ellipsePerimeter;html=1;align=center;shadow=0;dashed=0;spacingTop=3;image=img/lib/active_directory/windows_server.svg;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;384&quot; y=&quot;469&quot; width=&quot;41&quot; height=&quot;50&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;j0mtV--DJc_brgJgEW1E-8&quot; value=&quot;&quot; style=&quot;endArrow=none;html=1;rounded=0;entryX=0;entryY=1;entryDx=0;entryDy=0;&quot; parent=&quot;1&quot; target=&quot;j0mtV--DJc_brgJgEW1E-2&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry width=&quot;50&quot; height=&quot;50&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;94&quot; y=&quot;460&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;154&quot; y=&quot;380&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;j0mtV--DJc_brgJgEW1E-9&quot; value=&quot;&quot; style=&quot;endArrow=none;html=1;rounded=0;entryX=0.25;entryY=1;entryDx=0;entryDy=0;&quot; parent=&quot;1&quot; target=&quot;j0mtV--DJc_brgJgEW1E-2&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry width=&quot;50&quot; height=&quot;50&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;190&quot; y=&quot;470&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;344&quot; y=&quot;320&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;j0mtV--DJc_brgJgEW1E-10&quot; value=&quot;&quot; style=&quot;endArrow=none;html=1;rounded=0;entryX=0.75;entryY=1;entryDx=0;entryDy=0;&quot; parent=&quot;1&quot; target=&quot;j0mtV--DJc_brgJgEW1E-2&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry width=&quot;50&quot; height=&quot;50&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;294&quot; y=&quot;460&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;344&quot; y=&quot;320&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;j0mtV--DJc_brgJgEW1E-11&quot; value=&quot;&quot; style=&quot;endArrow=none;html=1;rounded=0;entryX=1;entryY=1;entryDx=0;entryDy=0;&quot; parent=&quot;1&quot; target=&quot;j0mtV--DJc_brgJgEW1E-2&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry width=&quot;50&quot; height=&quot;50&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;384&quot; y=&quot;460&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;274&quot; y=&quot;400&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;j0mtV--DJc_brgJgEW1E-12&quot; value=&quot;è·³æ¿æœº&quot; style=&quot;text;strokeColor=none;align=center;fillColor=none;html=1;verticalAlign=middle;whiteSpace=wrap;rounded=0;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;52&quot; y=&quot;520&quot; width=&quot;60&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;j0mtV--DJc_brgJgEW1E-13&quot; value=&quot;ç¬”è®°æœ¬ç”µè„‘&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;154&quot; y=&quot;528&quot; width=&quot;80&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;j0mtV--DJc_brgJgEW1E-14&quot; value=&quot;åˆ«çš„ç”µå­è®¾å¤‡&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;250&quot; y=&quot;528&quot; width=&quot;100&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;j0mtV--DJc_brgJgEW1E-15&quot; value=&quot;å®¿èˆæœåŠ¡å™¨&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;380&quot; y=&quot;528&quot; width=&quot;80&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;j0mtV--DJc_brgJgEW1E-18&quot; value=&quot;&quot; style=&quot;sketch=0;aspect=fixed;pointerEvents=1;shadow=0;dashed=0;html=1;strokeColor=none;labelPosition=center;verticalLabelPosition=bottom;verticalAlign=top;align=center;fillColor=#00188D;shape=mxgraph.azure.tablet;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;590&quot; y=&quot;338&quot; width=&quot;50&quot; height=&quot;37&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;j0mtV--DJc_brgJgEW1E-20&quot; value=&quot;è‹è²&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;590&quot; y=&quot;375&quot; width=&quot;50&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;j0mtV--DJc_brgJgEW1E-28&quot; value=&quot;å®¿èˆè·¯ç”±å™¨&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;290&quot; y=&quot;338&quot; width=&quot;80&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;j0mtV--DJc_brgJgEW1E-33&quot; value=&quot;æ ¡å†…è®¿é—®&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=39;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;460&quot; y=&quot;413.5&quot; width=&quot;180&quot; height=&quot;60&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;j0mtV--DJc_brgJgEW1E-34&quot; value=&quot;&quot; style=&quot;verticalLabelPosition=bottom;html=1;verticalAlign=top;align=center;strokeColor=none;fillColor=#00BEF2;shape=mxgraph.azure.cloud;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;250&quot; y=&quot;60&quot; width=&quot;287&quot; height=&quot;160&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;j0mtV--DJc_brgJgEW1E-29&quot; value=&quot;&quot; style=&quot;image;html=1;image=img/lib/clip_art/networking/Router_Icon_128x128.png&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;353.5&quot; y=&quot;110&quot; width=&quot;80&quot; height=&quot;80&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;j0mtV--DJc_brgJgEW1E-30&quot; value=&quot;æ ¡å›­ç½‘&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;363.5&quot; y=&quot;180&quot; width=&quot;60&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;j0mtV--DJc_brgJgEW1E-36&quot; value=&quot;&quot; style=&quot;endArrow=none;html=1;rounded=0;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.2;entryY=1;entryDx=0;entryDy=0;entryPerimeter=0;&quot; parent=&quot;1&quot; source=&quot;j0mtV--DJc_brgJgEW1E-2&quot; target=&quot;j0mtV--DJc_brgJgEW1E-34&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry width=&quot;50&quot; height=&quot;50&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;400&quot; y=&quot;310&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;450&quot; y=&quot;260&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;j0mtV--DJc_brgJgEW1E-37&quot; value=&quot;&quot; style=&quot;endArrow=none;html=1;rounded=0;entryX=0.9;entryY=1;entryDx=0;entryDy=0;entryPerimeter=0;exitX=0.02;exitY=0.02;exitDx=0;exitDy=0;exitPerimeter=0;&quot; parent=&quot;1&quot; source=&quot;j0mtV--DJc_brgJgEW1E-18&quot; target=&quot;j0mtV--DJc_brgJgEW1E-34&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry width=&quot;50&quot; height=&quot;50&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;610&quot; y=&quot;300&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;450&quot; y=&quot;240&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;j0mtV--DJc_brgJgEW1E-38&quot; value=&quot;&quot; style=&quot;curved=1;endArrow=classic;html=1;rounded=0;exitX=0;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;&quot; parent=&quot;1&quot; edge=&quot;1&quot; source=&quot;j0mtV--DJc_brgJgEW1E-18&quot;&gt;&#10;          &lt;mxGeometry width=&quot;50&quot; height=&quot;50&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;640&quot; y=&quot;350&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;240&quot; y=&quot;470&quot; as=&quot;targetPoint&quot; /&gt;&#10;            &lt;Array as=&quot;points&quot;&gt;&#10;              &lt;mxPoint x=&quot;530&quot; y=&quot;250&quot; /&gt;&#10;              &lt;mxPoint x=&quot;240&quot; y=&quot;240&quot; /&gt;&#10;              &lt;mxPoint x=&quot;60&quot; y=&quot;460&quot; /&gt;&#10;              &lt;mxPoint x=&quot;240&quot; y=&quot;370&quot; /&gt;&#10;            &lt;/Array&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;j0mtV--DJc_brgJgEW1E-41&quot; value=&quot;æ•°æ®è®¿é—®é€šè·¯&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;337.25&quot; y=&quot;250&quot; width=&quot;100&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;      &lt;/root&gt;&#10;    &lt;/mxGraphModel&gt;&#10;  &lt;/diagram&gt;&#10;&lt;/mxfile&gt;&#10;"><defs/><g><g><rect x="2.5" y="0" width="595.5" height="500" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/></g><g><image x="151.5" y="261.5" width="80" height="80" xlink:href="https://app.diagrams.net/img/lib/clip_art/networking/Router_Icon_128x128.png"/></g><g><image x="11.5" y="411.5" width="48" height="48" xlink:href="https://cdn2.iconfinder.com/data/icons/boxicons-regular-vol-3/24/bx-server-128.png" preserveAspectRatio="none"/></g><g><rect x="112" y="415.5" width="60" height="41" fill="none" stroke="none" pointer-events="all"/><path d="M 117.09 447.31 L 117.09 417.34 C 117.45 416.35 118.25 415.65 119.19 415.5 L 164.63 415.5 C 165.78 415.64 166.72 416.6 166.97 417.88 L 166.97 447.31 L 171.79 453.23 C 172 453.97 171.8 454.74 171.23 455.36 C 170.65 455.98 169.77 456.39 168.78 456.5 L 115.28 456.5 C 114.28 456.4 113.38 455.99 112.8 455.37 C 112.21 454.75 112 453.98 112.21 453.23 Z M 119.07 447.31 L 165.17 447.37 L 165.17 418.5 C 164.95 417.77 164.39 417.25 163.73 417.13 L 120.27 417.13 C 119.62 417.39 119.15 418.05 119.07 418.84 Z M 137.37 451.32 L 135.74 453.98 L 147.06 453.98 L 145.79 451.32 Z" fill="#00bef2" stroke="none" pointer-events="all"/></g><g><rect x="222" y="410" width="39" height="52" fill="none" stroke="none" pointer-events="all"/><path d="M 241.5 413.72 C 241.93 413.72 242.25 413.38 242.25 412.98 C 242.25 412.66 242.01 412.23 241.5 412.23 C 241.05 412.23 240.75 412.61 240.75 412.98 C 240.75 413.46 241.17 413.72 241.5 413.72 Z M 225.75 456.07 L 257.25 456.07 L 257.25 415.94 L 225.75 415.94 Z M 241.57 460.51 C 242.2 460.51 243 459.95 243 459.06 C 243 458.16 242.26 457.55 241.51 457.55 C 240.52 457.55 240 458.38 240 458.98 C 240 459.85 240.62 460.51 241.57 460.51 Z M 224.9 462 C 223.39 462 222 460.63 222 459.13 L 222 412.88 C 222 411.5 223.24 410 224.97 410 L 257.96 410 C 259.77 410 261 411.45 261 412.98 L 261 459.01 C 261 460.75 259.51 462 258.09 462 Z" fill="#505050" stroke="none" pointer-events="all"/></g><g><image x="331.5" y="410.5" width="41" height="50" xlink:href="https://app.diagrams.net/img/lib/active_directory/windows_server.svg"/></g><g><path d="M 42 402 L 152 342" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/></g><g><path d="M 138 412 L 172 342" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/></g><g><path d="M 242 402 L 212 342" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/></g><g><path d="M 332 402 L 232 342" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/></g><g><rect x="0" y="462" width="60" height="30" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 58px; height: 1px; padding-top: 477px; margin-left: 1px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">è·³æ¿æœº</div></div></div></foreignObject><text x="30" y="481" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">è·³æ¿æœº</text></switch></g></g><g><rect x="102" y="470" width="80" height="30" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 485px; margin-left: 142px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;">ç¬”è®°æœ¬ç”µè„‘</div></div></div></foreignObject><text x="142" y="489" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">ç¬”è®°æœ¬ç”µè„‘</text></switch></g></g><g><rect x="198" y="470" width="100" height="30" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 485px; margin-left: 248px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;">åˆ«çš„ç”µå­è®¾å¤‡</div></div></div></foreignObject><text x="248" y="489" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">åˆ«çš„ç”µå­è®¾å¤‡</text></switch></g></g><g><rect x="328" y="470" width="80" height="30" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 485px; margin-left: 368px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;">å®¿èˆæœåŠ¡å™¨</div></div></div></foreignObject><text x="368" y="489" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">å®¿èˆæœåŠ¡å™¨</text></switch></g></g><g><rect x="538" y="280" width="50" height="37" fill="none" stroke="none" pointer-events="all"/><path d="M 538.12 282.76 C 538 281.37 539.01 280.13 540.38 280 L 585.6 280 C 586.27 280.05 586.89 280.37 587.32 280.89 C 587.76 281.41 587.97 282.08 587.91 282.76 L 587.91 314.29 C 588 315.68 586.97 316.89 585.6 317 L 540.33 317 C 539 316.84 538.03 315.65 538.12 314.29 Z M 541.79 313.17 L 584.09 313.17 L 584.09 283.83 L 541.79 283.83 Z M 566.39 315.93 C 566.77 315.79 567.04 315.42 567.04 315.01 C 567.04 314.59 566.77 314.22 566.39 314.09 L 559.44 314.09 C 559.06 314.22 558.79 314.59 558.79 315.01 C 558.79 315.42 559.06 315.79 559.44 315.93 Z" fill="#00188d" stroke="none" pointer-events="all"/></g><g><rect x="538" y="317" width="50" height="30" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 332px; margin-left: 563px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;">è‹è²</div></div></div></foreignObject><text x="563" y="336" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">è‹è²</text></switch></g></g><g><rect x="238" y="280" width="80" height="30" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 295px; margin-left: 278px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;">å®¿èˆè·¯ç”±å™¨</div></div></div></foreignObject><text x="278" y="299" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">å®¿èˆè·¯ç”±å™¨</text></switch></g></g><g><rect x="408" y="355.5" width="180" height="60" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 386px; margin-left: 498px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 39px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;">æ ¡å†…è®¿é—®</div></div></div></foreignObject><text x="498" y="397" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="39px" text-anchor="middle">æ ¡å†…è®¿é—®</text></switch></g></g><g><path d="M 255.35 161.59 C 232.62 159.42 213.35 146.46 205.71 128.21 C 198.07 109.97 203.4 89.63 219.44 75.83 C 235.47 62.03 259.41 57.18 281.09 63.35 C 290.12 38 314.44 18.67 344.89 12.62 C 375.34 6.57 407.28 14.73 428.7 34.02 C 450.11 53.31 457.74 80.81 448.7 106.15 C 465.8 105.64 480.55 116.21 482.78 130.57 C 485 144.92 473.96 158.36 457.28 161.59 C 457.37 161.39 255.01 162 255.01 162 Z" fill="#00bef2" stroke="none" pointer-events="all"/></g><g><image x="301" y="51.5" width="80" height="80" xlink:href="https://app.diagrams.net/img/lib/clip_art/networking/Router_Icon_128x128.png"/></g><g><rect x="311.5" y="122" width="60" height="30" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 137px; margin-left: 342px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;">æ ¡å›­ç½‘</div></div></div></foreignObject><text x="342" y="141" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">æ ¡å›­ç½‘</text></switch></g></g><g><path d="M 192 262 L 255.4 162" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/></g><g><path d="M 539 280.74 L 456.3 162" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/></g><g><path d="M 538 298.5 Q 478 192 333 187 Q 188 182 98 292 Q 8 402 98 357 Q 188 312 188 405.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 188 410.88 L 184.5 403.88 L 188 405.63 L 191.5 403.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/></g><g><rect x="285.25" y="192" width="100" height="30" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 207px; margin-left: 335px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;">æ•°æ®è®¿é—®é€šè·¯</div></div></div></foreignObject><text x="335" y="211" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">æ•°æ®è®¿é—®é€šè·¯</text></switch></g></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://www.drawio.com/doc/faq/svg-export-text-problems" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Text is not SVG - cannot display</text></a></switch></svg></p>
<p><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="649px" height="529px" viewBox="-0.5 -0.5 649 529" content="&lt;mxfile host=&quot;app.diagrams.net&quot; modified=&quot;2024-03-02T08:13:34.141Z&quot; agent=&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 &quot; etag=&quot;yR38gaVAreyUvvZ6bsVm&quot; version=&quot;24.0.0&quot; type=&quot;device&quot;&gt;&#10;  &lt;diagram name=&quot;Page-1&quot; id=&quot;dI_hwNI-IPbiKV3huhqv&quot;&gt;&#10;    &lt;mxGraphModel dx=&quot;1050&quot; dy=&quot;564&quot; grid=&quot;1&quot; gridSize=&quot;10&quot; guides=&quot;1&quot; tooltips=&quot;1&quot; connect=&quot;1&quot; arrows=&quot;1&quot; fold=&quot;1&quot; page=&quot;1&quot; pageScale=&quot;1&quot; pageWidth=&quot;850&quot; pageHeight=&quot;1100&quot; math=&quot;0&quot; shadow=&quot;0&quot;&gt;&#10;      &lt;root&gt;&#10;        &lt;mxCell id=&quot;0&quot; /&gt;&#10;        &lt;mxCell id=&quot;1&quot; parent=&quot;0&quot; /&gt;&#10;        &lt;mxCell id=&quot;XMfhzKKKdkuSQOpPAiJ0-55&quot; value=&quot;&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;60&quot; y=&quot;30&quot; width=&quot;640&quot; height=&quot;520&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;XMfhzKKKdkuSQOpPAiJ0-1&quot; value=&quot;&quot; style=&quot;image;html=1;image=img/lib/clip_art/networking/Router_Icon_128x128.png&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;204&quot; y=&quot;320&quot; width=&quot;80&quot; height=&quot;80&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;XMfhzKKKdkuSQOpPAiJ0-3&quot; value=&quot;&quot; style=&quot;shape=image;html=1;verticalAlign=top;verticalLabelPosition=bottom;labelBackgroundColor=#ffffff;imageAspect=0;aspect=fixed;image=https://cdn0.iconfinder.com/data/icons/social-network-8/50/37-128.png&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;204&quot; y=&quot;30&quot; width=&quot;80&quot; height=&quot;80&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;XMfhzKKKdkuSQOpPAiJ0-4&quot; value=&quot;&quot; style=&quot;shape=image;html=1;verticalAlign=top;verticalLabelPosition=bottom;labelBackgroundColor=#ffffff;imageAspect=0;aspect=fixed;image=https://cdn2.iconfinder.com/data/icons/boxicons-regular-vol-3/24/bx-server-128.png&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;64&quot; y=&quot;470&quot; width=&quot;48&quot; height=&quot;48&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;XMfhzKKKdkuSQOpPAiJ0-5&quot; value=&quot;&quot; style=&quot;verticalLabelPosition=bottom;html=1;verticalAlign=top;align=center;strokeColor=none;fillColor=#00BEF2;shape=mxgraph.azure.laptop;pointerEvents=1;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;164&quot; y=&quot;473.5&quot; width=&quot;60&quot; height=&quot;41&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;XMfhzKKKdkuSQOpPAiJ0-6&quot; value=&quot;&quot; style=&quot;sketch=0;pointerEvents=1;shadow=0;dashed=0;html=1;strokeColor=none;fillColor=#505050;labelPosition=center;verticalLabelPosition=bottom;verticalAlign=top;outlineConnect=0;align=center;shape=mxgraph.office.devices.tablet_ipad;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;274&quot; y=&quot;468&quot; width=&quot;39&quot; height=&quot;52&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;XMfhzKKKdkuSQOpPAiJ0-7&quot; value=&quot;&quot; style=&quot;image;aspect=fixed;perimeter=ellipsePerimeter;html=1;align=center;shadow=0;dashed=0;spacingTop=3;image=img/lib/active_directory/windows_server.svg;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;384&quot; y=&quot;469&quot; width=&quot;41&quot; height=&quot;50&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;XMfhzKKKdkuSQOpPAiJ0-8&quot; value=&quot;&quot; style=&quot;endArrow=none;html=1;rounded=0;entryX=0;entryY=1;entryDx=0;entryDy=0;&quot; parent=&quot;1&quot; target=&quot;XMfhzKKKdkuSQOpPAiJ0-1&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry width=&quot;50&quot; height=&quot;50&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;94&quot; y=&quot;460&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;154&quot; y=&quot;380&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;XMfhzKKKdkuSQOpPAiJ0-9&quot; value=&quot;&quot; style=&quot;endArrow=none;html=1;rounded=0;entryX=0.25;entryY=1;entryDx=0;entryDy=0;&quot; parent=&quot;1&quot; target=&quot;XMfhzKKKdkuSQOpPAiJ0-1&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry width=&quot;50&quot; height=&quot;50&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;190&quot; y=&quot;470&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;344&quot; y=&quot;320&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;XMfhzKKKdkuSQOpPAiJ0-10&quot; value=&quot;&quot; style=&quot;endArrow=none;html=1;rounded=0;entryX=0.75;entryY=1;entryDx=0;entryDy=0;&quot; parent=&quot;1&quot; target=&quot;XMfhzKKKdkuSQOpPAiJ0-1&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry width=&quot;50&quot; height=&quot;50&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;294&quot; y=&quot;460&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;344&quot; y=&quot;320&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;XMfhzKKKdkuSQOpPAiJ0-12&quot; value=&quot;&quot; style=&quot;endArrow=none;html=1;rounded=0;entryX=1;entryY=1;entryDx=0;entryDy=0;&quot; parent=&quot;1&quot; target=&quot;XMfhzKKKdkuSQOpPAiJ0-1&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry width=&quot;50&quot; height=&quot;50&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;384&quot; y=&quot;460&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;274&quot; y=&quot;400&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;XMfhzKKKdkuSQOpPAiJ0-15&quot; value=&quot;è·³æ¿æœº&quot; style=&quot;text;strokeColor=none;align=center;fillColor=none;html=1;verticalAlign=middle;whiteSpace=wrap;rounded=0;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;52&quot; y=&quot;520&quot; width=&quot;60&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;XMfhzKKKdkuSQOpPAiJ0-16&quot; value=&quot;ç¬”è®°æœ¬ç”µè„‘&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;154&quot; y=&quot;528&quot; width=&quot;80&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;XMfhzKKKdkuSQOpPAiJ0-17&quot; value=&quot;åˆ«çš„ç”µå­è®¾å¤‡&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;250&quot; y=&quot;528&quot; width=&quot;100&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;XMfhzKKKdkuSQOpPAiJ0-18&quot; value=&quot;å®¿èˆæœåŠ¡å™¨&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;380&quot; y=&quot;528&quot; width=&quot;80&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;XMfhzKKKdkuSQOpPAiJ0-19&quot; value=&quot;å›½å†…VPS&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;140&quot; y=&quot;55&quot; width=&quot;70&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;XMfhzKKKdkuSQOpPAiJ0-21&quot; value=&quot;&quot; style=&quot;sketch=0;pointerEvents=1;shadow=0;dashed=0;html=1;strokeColor=none;fillColor=#505050;labelPosition=center;verticalLabelPosition=bottom;verticalAlign=top;outlineConnect=0;align=center;shape=mxgraph.office.devices.cell_phone_iphone_proportional;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;610&quot; y=&quot;221&quot; width=&quot;20&quot; height=&quot;43&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;XMfhzKKKdkuSQOpPAiJ0-22&quot; value=&quot;&quot; style=&quot;sketch=0;aspect=fixed;pointerEvents=1;shadow=0;dashed=0;html=1;strokeColor=none;labelPosition=center;verticalLabelPosition=bottom;verticalAlign=top;align=center;fillColor=#00188D;shape=mxgraph.azure.tablet;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;620&quot; y=&quot;316.5&quot; width=&quot;50&quot; height=&quot;37&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;XMfhzKKKdkuSQOpPAiJ0-23&quot; value=&quot;æ‰‹æœºçƒ­ç‚¹&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;630&quot; y=&quot;227.5&quot; width=&quot;70&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;XMfhzKKKdkuSQOpPAiJ0-24&quot; value=&quot;è‹è²&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;620&quot; y=&quot;359.5&quot; width=&quot;50&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;XMfhzKKKdkuSQOpPAiJ0-25&quot; value=&quot;&quot; style=&quot;fontColor=#0066CC;verticalAlign=top;verticalLabelPosition=bottom;labelPosition=center;align=center;html=1;outlineConnect=0;fillColor=#CCCCCC;strokeColor=#6881B3;gradientColor=none;gradientDirection=north;strokeWidth=2;shape=mxgraph.networks.radio_tower;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;590&quot; y=&quot;30&quot; width=&quot;55&quot; height=&quot;100&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;XMfhzKKKdkuSQOpPAiJ0-26&quot; value=&quot;æµé‡å¡åŸºç«™&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;580&quot; y=&quot;130&quot; width=&quot;80&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;XMfhzKKKdkuSQOpPAiJ0-27&quot; value=&quot;&quot; style=&quot;endArrow=none;html=1;rounded=0;exitX=0.02;exitY=0.02;exitDx=0;exitDy=0;exitPerimeter=0;&quot; parent=&quot;1&quot; target=&quot;XMfhzKKKdkuSQOpPAiJ0-21&quot; edge=&quot;1&quot; source=&quot;XMfhzKKKdkuSQOpPAiJ0-22&quot;&gt;&#10;          &lt;mxGeometry width=&quot;50&quot; height=&quot;50&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;740&quot; y=&quot;320&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;420&quot; y=&quot;270&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;XMfhzKKKdkuSQOpPAiJ0-28&quot; value=&quot;&quot; style=&quot;endArrow=none;html=1;rounded=0;&quot; parent=&quot;1&quot; source=&quot;XMfhzKKKdkuSQOpPAiJ0-21&quot; target=&quot;XMfhzKKKdkuSQOpPAiJ0-26&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry width=&quot;50&quot; height=&quot;50&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;700&quot; y=&quot;240&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;750&quot; y=&quot;190&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;XMfhzKKKdkuSQOpPAiJ0-29&quot; value=&quot;&quot; style=&quot;endArrow=none;html=1;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;&quot; parent=&quot;1&quot; source=&quot;XMfhzKKKdkuSQOpPAiJ0-3&quot; target=&quot;XMfhzKKKdkuSQOpPAiJ0-25&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry width=&quot;50&quot; height=&quot;50&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;370&quot; y=&quot;320&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;420&quot; y=&quot;270&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;XMfhzKKKdkuSQOpPAiJ0-30&quot; value=&quot;&quot; style=&quot;curved=1;endArrow=classic;html=1;rounded=0;exitX=0;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;&quot; parent=&quot;1&quot; edge=&quot;1&quot; source=&quot;XMfhzKKKdkuSQOpPAiJ0-22&quot;&gt;&#10;          &lt;mxGeometry width=&quot;50&quot; height=&quot;50&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;740&quot; y=&quot;340&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;170&quot; y=&quot;460&quot; as=&quot;targetPoint&quot; /&gt;&#10;            &lt;Array as=&quot;points&quot;&gt;&#10;              &lt;mxPoint x=&quot;560&quot; y=&quot;290&quot; /&gt;&#10;              &lt;mxPoint x=&quot;570&quot; y=&quot;100&quot; /&gt;&#10;              &lt;mxPoint x=&quot;230&quot; y=&quot;70&quot; /&gt;&#10;              &lt;mxPoint x=&quot;160&quot; y=&quot;170&quot; /&gt;&#10;              &lt;mxPoint x=&quot;130&quot; y=&quot;280&quot; /&gt;&#10;              &lt;mxPoint x=&quot;50&quot; y=&quot;490&quot; /&gt;&#10;              &lt;mxPoint x=&quot;210&quot; y=&quot;360&quot; /&gt;&#10;            &lt;/Array&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;XMfhzKKKdkuSQOpPAiJ0-31&quot; value=&quot;æ•°æ®è®¿é—®é€šè·¯&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;354.5&quot; y=&quot;100&quot; width=&quot;100&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;XMfhzKKKdkuSQOpPAiJ0-32&quot; value=&quot;å®¿èˆè·¯ç”±å™¨&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;290&quot; y=&quot;338&quot; width=&quot;80&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;XMfhzKKKdkuSQOpPAiJ0-33&quot; value=&quot;&quot; style=&quot;image;html=1;image=img/lib/clip_art/networking/Router_Icon_128x128.png&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;204&quot; y=&quot;190&quot; width=&quot;80&quot; height=&quot;80&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;XMfhzKKKdkuSQOpPAiJ0-34&quot; value=&quot;æ ¡å›­ç½‘è·¯ç”±å™¨&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;284&quot; y=&quot;210&quot; width=&quot;100&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;XMfhzKKKdkuSQOpPAiJ0-35&quot; value=&quot;&quot; style=&quot;endArrow=none;html=1;rounded=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;exitX=0.5;exitY=0;exitDx=0;exitDy=0;&quot; parent=&quot;1&quot; source=&quot;XMfhzKKKdkuSQOpPAiJ0-33&quot; target=&quot;XMfhzKKKdkuSQOpPAiJ0-3&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry width=&quot;50&quot; height=&quot;50&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;370&quot; y=&quot;320&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;420&quot; y=&quot;270&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;XMfhzKKKdkuSQOpPAiJ0-36&quot; value=&quot;&quot; style=&quot;endArrow=none;html=1;rounded=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;exitX=0.5;exitY=0;exitDx=0;exitDy=0;&quot; parent=&quot;1&quot; source=&quot;XMfhzKKKdkuSQOpPAiJ0-1&quot; target=&quot;XMfhzKKKdkuSQOpPAiJ0-33&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry width=&quot;50&quot; height=&quot;50&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;310&quot; y=&quot;344&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;310&quot; y=&quot;264&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;XMfhzKKKdkuSQOpPAiJ0-56&quot; value=&quot;æ ¡å¤–è®¿é—®&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=39;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;505&quot; y=&quot;393&quot; width=&quot;180&quot; height=&quot;60&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;      &lt;/root&gt;&#10;    &lt;/mxGraphModel&gt;&#10;  &lt;/diagram&gt;&#10;&lt;/mxfile&gt;&#10;"><defs/><g><g><rect x="8" y="1" width="640" height="520" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/></g><g><image x="151.5" y="290.5" width="80" height="80" xlink:href="https://app.diagrams.net/img/lib/clip_art/networking/Router_Icon_128x128.png"/></g><g><image x="151.5" y="0.5" width="80" height="80" xlink:href="https://cdn0.iconfinder.com/data/icons/social-network-8/50/37-128.png" preserveAspectRatio="none"/></g><g><image x="11.5" y="440.5" width="48" height="48" xlink:href="https://cdn2.iconfinder.com/data/icons/boxicons-regular-vol-3/24/bx-server-128.png" preserveAspectRatio="none"/></g><g><rect x="112" y="444.5" width="60" height="41" fill="none" stroke="none" pointer-events="all"/><path d="M 117.09 476.31 L 117.09 446.34 C 117.45 445.35 118.25 444.65 119.19 444.5 L 164.63 444.5 C 165.78 444.64 166.72 445.6 166.97 446.88 L 166.97 476.31 L 171.79 482.23 C 172 482.97 171.8 483.74 171.23 484.36 C 170.65 484.98 169.77 485.39 168.78 485.5 L 115.28 485.5 C 114.28 485.4 113.38 484.99 112.8 484.37 C 112.21 483.75 112 482.98 112.21 482.23 Z M 119.07 476.31 L 165.17 476.37 L 165.17 447.5 C 164.95 446.77 164.39 446.25 163.73 446.13 L 120.27 446.13 C 119.62 446.39 119.15 447.05 119.07 447.84 Z M 137.37 480.32 L 135.74 482.98 L 147.06 482.98 L 145.79 480.32 Z" fill="#00bef2" stroke="none" pointer-events="all"/></g><g><rect x="222" y="439" width="39" height="52" fill="none" stroke="none" pointer-events="all"/><path d="M 241.5 442.72 C 241.93 442.72 242.25 442.38 242.25 441.98 C 242.25 441.66 242.01 441.23 241.5 441.23 C 241.05 441.23 240.75 441.61 240.75 441.98 C 240.75 442.46 241.17 442.72 241.5 442.72 Z M 225.75 485.07 L 257.25 485.07 L 257.25 444.94 L 225.75 444.94 Z M 241.57 489.51 C 242.2 489.51 243 488.95 243 488.06 C 243 487.16 242.26 486.55 241.51 486.55 C 240.52 486.55 240 487.38 240 487.98 C 240 488.85 240.62 489.51 241.57 489.51 Z M 224.9 491 C 223.39 491 222 489.63 222 488.13 L 222 441.88 C 222 440.5 223.24 439 224.97 439 L 257.96 439 C 259.77 439 261 440.45 261 441.98 L 261 488.01 C 261 489.75 259.51 491 258.09 491 Z" fill="#505050" stroke="none" pointer-events="all"/></g><g><image x="331.5" y="439.5" width="41" height="50" xlink:href="https://app.diagrams.net/img/lib/active_directory/windows_server.svg"/></g><g><path d="M 42 431 L 152 371" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/></g><g><path d="M 138 441 L 172 371" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/></g><g><path d="M 242 431 L 212 371" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/></g><g><path d="M 332 431 L 232 371" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/></g><g><rect x="0" y="491" width="60" height="30" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 58px; height: 1px; padding-top: 506px; margin-left: 1px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">è·³æ¿æœº</div></div></div></foreignObject><text x="30" y="510" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">è·³æ¿æœº</text></switch></g></g><g><rect x="102" y="499" width="80" height="30" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 514px; margin-left: 142px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;">ç¬”è®°æœ¬ç”µè„‘</div></div></div></foreignObject><text x="142" y="518" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">ç¬”è®°æœ¬ç”µè„‘</text></switch></g></g><g><rect x="198" y="499" width="100" height="30" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 514px; margin-left: 248px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;">åˆ«çš„ç”µå­è®¾å¤‡</div></div></div></foreignObject><text x="248" y="518" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">åˆ«çš„ç”µå­è®¾å¤‡</text></switch></g></g><g><rect x="328" y="499" width="80" height="30" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 514px; margin-left: 368px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;">å®¿èˆæœåŠ¡å™¨</div></div></div></foreignObject><text x="368" y="518" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">å®¿èˆæœåŠ¡å™¨</text></switch></g></g><g><rect x="88" y="26" width="70" height="30" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 41px; margin-left: 123px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;">å›½å†…VPS</div></div></div></foreignObject><text x="123" y="45" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">å›½å†…VPS</text></switch></g></g><g><rect x="558" y="192" width="20" height="43" fill="none" stroke="none" pointer-events="all"/><path d="M 570.14 195.2 C 570.32 195.2 570.41 195.1 570.41 194.87 C 570.41 194.66 570.3 194.54 570.14 194.54 L 565.93 194.54 C 565.75 194.54 565.69 194.75 565.69 194.87 C 565.69 195.01 565.79 195.2 565.93 195.2 Z M 575.47 227.28 L 575.47 198.62 L 560.62 198.62 L 560.62 227.28 Z M 568.06 232.81 C 568.58 232.81 569.36 232.3 569.36 231.1 C 569.36 230.27 568.77 229.5 568.06 229.5 C 567.26 229.5 566.74 230.34 566.74 231.1 C 566.74 232.28 567.5 232.81 568.06 232.81 Z M 560.57 235 C 559.25 235 558 233.71 558 231.71 L 558 195.31 C 558 193.47 559.13 192 560.59 192 L 575.33 192 C 576.91 192 578 193.6 578 195.26 L 578 231.68 C 578 233.84 576.63 235 575.47 235 Z" fill="#505050" stroke="none" pointer-events="all"/></g><g><rect x="568" y="287.5" width="50" height="37" fill="none" stroke="none" pointer-events="all"/><path d="M 568.12 290.26 C 568 288.87 569.01 287.63 570.38 287.5 L 615.6 287.5 C 616.27 287.55 616.89 287.87 617.32 288.39 C 617.76 288.91 617.97 289.58 617.91 290.26 L 617.91 321.79 C 618 323.18 616.97 324.39 615.6 324.5 L 570.33 324.5 C 569 324.34 568.03 323.15 568.12 321.79 Z M 571.79 320.67 L 614.09 320.67 L 614.09 291.33 L 571.79 291.33 Z M 596.39 323.43 C 596.77 323.29 597.04 322.92 597.04 322.51 C 597.04 322.09 596.77 321.72 596.39 321.59 L 589.44 321.59 C 589.06 321.72 588.79 322.09 588.79 322.51 C 588.79 322.92 589.06 323.29 589.44 323.43 Z" fill="#00188d" stroke="none" pointer-events="all"/></g><g><rect x="578" y="198.5" width="70" height="30" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 214px; margin-left: 613px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;">æ‰‹æœºçƒ­ç‚¹</div></div></div></foreignObject><text x="613" y="217" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">æ‰‹æœºçƒ­ç‚¹</text></switch></g></g><g><rect x="568" y="330.5" width="50" height="30" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 346px; margin-left: 593px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;">è‹è²</div></div></div></foreignObject><text x="593" y="349" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">è‹è²</text></switch></g></g><g><path d="M 542.82 101 L 565.5 17.5 L 588.18 101" fill="none" stroke="#6881b3" stroke-width="2.02" stroke-linejoin="round" stroke-miterlimit="10" pointer-events="all"/><path d="M 587.15 95.43 L 549 78.73 L 578.9 67.6 L 555.7 56.47 L 572.72 45.84 L 560.86 36.22" fill="none" stroke="#6881b3" stroke-width="2.02" stroke-linejoin="round" stroke-miterlimit="10" pointer-events="all"/><rect x="538" y="1" width="0" height="0" fill="none" stroke="#6881b3" stroke-width="2.02" pointer-events="all"/><ellipse cx="565.5" cy="19.52" rx="4.1244844394450695" ry="4.048582995951417" fill="#cccccc" stroke="#6881b3" stroke-width="2.02" pointer-events="all"/><path d="M 572.51 12.64 L 573.96 10.92 C 578.67 15.64 578.67 23.2 573.96 27.92 L 572.51 26.3 C 576.12 22.44 576.12 16.51 572.51 12.64 Z M 577.67 7.58 L 579.11 6.16 C 586.44 13.61 586.44 25.43 579.11 32.88 L 577.67 31.47 C 584.21 24.8 584.21 14.24 577.67 7.58 Z M 582.82 2.52 L 584.27 1 C 589.81 5.62 593 12.39 593 19.52 C 593 26.66 589.81 33.43 584.27 38.04 L 582.82 36.53 C 588.09 32.4 591.16 26.14 591.16 19.52 C 591.16 12.91 588.09 6.65 582.82 2.52 Z M 558.49 12.64 L 557.04 10.92 C 552.33 15.64 552.33 23.2 557.04 27.92 L 558.49 26.3 C 554.88 22.44 554.88 16.51 558.49 12.64 Z M 553.33 7.58 L 551.89 6.16 C 544.56 13.61 544.56 25.43 551.89 32.88 L 553.33 31.47 C 546.79 24.8 546.79 14.24 553.33 7.58 Z M 548.18 2.52 L 546.73 1 C 541.19 5.62 538 12.39 538 19.52 C 538 26.66 541.19 33.43 546.73 38.04 L 548.18 36.53 C 542.91 32.4 539.84 26.14 539.84 19.52 C 539.84 12.91 542.91 6.65 548.18 2.52 Z" fill="#cccccc" stroke="#6881b3" stroke-width="2.02" stroke-miterlimit="10" pointer-events="all"/></g><g><rect x="528" y="101" width="80" height="30" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 116px; margin-left: 568px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;">æµé‡å¡åŸºç«™</div></div></div></foreignObject><text x="568" y="120" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">æµé‡å¡åŸºç«™</text></switch></g></g><g><path d="M 569 288.24 L 568.29 235" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/></g><g><path d="M 568 192 L 568 131" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/></g><g><path d="M 232 41 L 538 50.18" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/></g><g><path d="M 568 306 Q 508 261 513 166 Q 518 71 348 56 Q 178 41 143 91 Q 108 141 93 196 Q 78 251 38 356 Q -2 461 78 396 Q 158 331 120.37 425.09" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 118.42 429.96 L 117.77 422.16 L 120.37 425.09 L 124.26 424.76 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/></g><g><rect x="302.5" y="71" width="100" height="30" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 86px; margin-left: 353px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;">æ•°æ®è®¿é—®é€šè·¯</div></div></div></foreignObject><text x="353" y="90" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">æ•°æ®è®¿é—®é€šè·¯</text></switch></g></g><g><rect x="238" y="309" width="80" height="30" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 324px; margin-left: 278px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;">å®¿èˆè·¯ç”±å™¨</div></div></div></foreignObject><text x="278" y="328" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">å®¿èˆè·¯ç”±å™¨</text></switch></g></g><g><image x="151.5" y="160.5" width="80" height="80" xlink:href="https://app.diagrams.net/img/lib/clip_art/networking/Router_Icon_128x128.png"/></g><g><rect x="232" y="181" width="100" height="30" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 196px; margin-left: 282px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;">æ ¡å›­ç½‘è·¯ç”±å™¨</div></div></div></foreignObject><text x="282" y="200" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">æ ¡å›­ç½‘è·¯ç”±å™¨</text></switch></g></g><g><path d="M 192 161 L 192 81" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/></g><g><path d="M 192 291 L 192 241" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/></g><g><rect x="453" y="364" width="180" height="60" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 394px; margin-left: 543px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 39px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;">æ ¡å¤–è®¿é—®</div></div></div></foreignObject><text x="543" y="406" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="39px" text-anchor="middle">æ ¡å¤–è®¿é—®</text></switch></g></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://www.drawio.com/doc/faq/svg-export-text-problems" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Text is not SVG - cannot display</text></a></switch></svg></p>
<p>(å›¾ç‰‡ä½¿ç”¨<a target="_blank" rel="noopener" href="https://app.diagrams.net/">Draw IO</a>ç»˜åˆ¶svg)</p>
<p>è¿™ä¹ˆåšç¡®å®æŒºæ–¹ä¾¿ï¼Œæˆ‘åœ¨å»å¹´è€ƒç ”æœŸé—´å°±æ˜¯å…¨ç¨‹è¿™æ ·æ“ä½œçš„ï¼Œå› ä¸ºå®åœ¨ä¸æƒ³æŠŠæ¸¸æˆæœ¬å¸¦åˆ°å›¾ä¹¦é¦†ï¼Œä¸ä»…ç”µæºå¤§è¿˜é‡ï¼Œè¿˜ä¸æ”¯æŒå……ç”µå®ä¾›ç”µï¼Œè€Œä¸”è¿™ç”µè„‘åœ¨ä¹°æ¥ä¸€å¹´ä¸åˆ°çš„æ—¶å€™å› å†…å­˜æ¡è™šç„Šè€Œè·Ÿå”®åæ‰¯çš®ä¸€ä¸ªæœˆæ‰åŒæ„ç»™æˆ‘ä¿å†…æ¢ä¸»æ¿ã€‚</p>
<p><strong>è¿™ä¹ˆåšçš„é—®é¢˜åœ¨äºï¼Œéœ€è¦ä¸€ä¸ªæœ‰çº¿çš„ç½‘ç»œç¯å¢ƒï¼Œæœ€å·®æƒ…å†µå°±æ˜¯è·¯ç”±å™¨è¦æ”¯æŒæ— çº¿æ¡¥æ¥ã€‚</strong> ä½†æ˜¯æˆ‘å®¿èˆé‡Œçš„è·¯ç”±å™¨æ˜¯2010å¹´ä»£çš„ä¸Šå¤TP-Linkï¼Œè€Œä¸”æˆªè‡³ä»Šå¤©å†™ç¨¿ï¼Œå·²å›æ ¡ä¸€å‘¨ï¼Œå®¿èˆæœ‰çº¿å®½å¸¦ä¾æ—§æ²¡æ¢å¤ï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿ<del><em>é‡ä¹°è§£å†³100%é—®é¢˜</em></del></p>
<p>æˆ‘å¼€å§‹è€ƒè™‘<code>CloudFlare</code>çš„<code>DDNS</code>æœåŠ¡äº†ã€‚æ°å¥½å¤§ä¸€åŠçš„æ ¡å›­æµé‡å¡ä¸€ä¸ªæœˆèƒ½æœ‰150GBæ ¡å†…æµé‡ï¼Œåæ­£ç”¨ä¸å®Œä½•ä¸ç”¨æ¥ç»™ç”µè„‘æä¸ª<code>ipv6</code>çš„ddnså‘¢ï¼Ÿç”šè‡³è¿˜èƒ½æœ‰å…¨çƒçš„å…¬ç½‘ipï¼Œä¸€ä¸¾ä¸¤å¾—ï¼</p>
<h1 id="CloudFlare-DDNSçš„é…ç½®"><a href="#CloudFlare-DDNSçš„é…ç½®" class="headerlink" title="CloudFlare DDNSçš„é…ç½®"></a>CloudFlare DDNSçš„é…ç½®</h1><p>ä¸Šç½‘æ‰¾äº†ä¸€åœˆï¼Œå…¨æ˜¯ç”¨ç¬¬ä¸‰æ–¹é›†æˆå¼çš„å¼€æºé¡¹ç›®æˆ–è€…<code>OpenWRT</code>é‡Œçš„DDNSæ¨¡å—ã€‚<br>æˆ‘çš„éœ€æ±‚æ˜¯ï¼š</p>
<blockquote>
<p>èƒ½åœ¨<code>Windows</code>ã€<code>Linux</code>å¹³å°ä¸‹é€šè·‘ã€‚<br>æ— è§†<code>CPU</code>å¹³å°é™åˆ¶ã€‚<br>å¼ºè°ƒåœ¨ä½æ€§èƒ½çš„<code>Linux</code>å¹³å°ä¸‹çš„é«˜è¿è¡Œæ•ˆç‡ã€‚<br>ä½¿ç”¨é…ç½®æ–‡ä»¶è¿›è¡Œ<code>DDNS</code>ï¼Œä¸èƒ½æŠŠç”¨æˆ·ä¿¡æ¯å†™æ­»è¿›è„šæœ¬é‡Œã€‚</p>
</blockquote>
<p>æœ€ç»ˆå†³å®šä½¿ç”¨<code>Shell</code>å’Œ<code>Python</code>å„ç¼–å†™ä¸€ä»½ï¼Œ<code>Linux</code>å¹³å°ä¸‹ç”¨<code>Shell</code>ï¼Œ<code>Windows</code>ä¸‹ç”¨<code>Python</code>ã€‚<br>åœ¨ç¼–å†™æ—¶å‚è€ƒäº†<a target="_blank" rel="noopener" href="https://github.com/wherelse/cloudflare-ddns-script">wherelse&#x2F;cloudflare-ddns-script</a>çš„è„šæœ¬ã€‚</p>
<p>ç¬¬ä¸€æ¬¡è¿è¡Œæ—¶ï¼Œä¼šåœ¨è„šæœ¬åŒçº§ç›®å½•ä¸‹ç”Ÿæˆ<code>config.txt</code>ï¼Œå‘é‡Œé¢å¡«å†™ä½ çš„ä¸ªäººä¿¡æ¯ï¼Œç„¶åé‡æ–°è¿è¡Œå³å¯ã€‚**<code>Python</code>ç‰ˆå’Œ<code>Shell</code>ç‰ˆçš„é…ç½®æ–‡ä»¶é€šç”¨ï¼**</p>
<p>é…ç½®æ–‡ä»¶å¡«å†™å‚è€ƒè¿™é‡Œ:</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs Text">cf_email_addr=a@b.c  # cloudFlareæ³¨å†Œè´¦æˆ·é‚®ç®±<br>cf_global_api_key=1145141919810   # ä½ çš„cloudflareè´¦æˆ·Globel API Key<br>domain_main=example.com   # ä½ çš„ä¸»åŸŸå, å¦‚example.com<br>domain_full_ddns=ddnsv6.example.com # ddnsç”¨çš„å®Œæ•´åŸŸå, å¦‚ddns.example.com<br>record_type=AAAA             # A or AAAA,ipv4 æˆ– ipv6è§£æ<br>eth_card=eth0             # ä½¿ç”¨æœ¬åœ°æ–¹å¼è·å–ipç»‘å®šçš„ç½‘å¡, å¦‚eth0<br>ip_index=local            # use &quot;internet&quot; or &quot;local&quot;,ä½¿ç”¨æœ¬åœ°æ–¹å¼è¿˜æ˜¯ç½‘ç»œæ–¹å¼è·å–åœ°å€<br>reset_ip=0 # 1ä¸ºå°†ddnsçš„ipæ”¹ä¸ºlocalhostï¼Œ2ä¸ºæ‰‹åŠ¨è¾“å…¥ipï¼Œå…¶ä»–ä»»æ„å€¼ä¸ºä¸æ˜¯<br>enable_cache=0              # 1ä¸ºä¿å­˜ç¼“å­˜æ–‡ä»¶,å…¶ä»–ä»»æ„å€¼ä¸ºä¸ä¿å­˜ã€‚ä¿å­˜ç¼“å­˜æ–‡ä»¶å¯è®©ä¸‹æ¬¡ddnsæ›´æ–°é€Ÿåº¦æ›´å¿«ï¼Œä½†ç¼“å­˜æ–‡ä»¶æ³„æ¼éœ€è¦ä½ å»æŠŠcf_global_api_keyé‡æ–°revokeä¸€æ¬¡ï¼Œä¸ç„¶ä¼šé€ æˆéšç§æ³„æ¼<br>skip_connectivity_check=0 # 0ä¸ºä¸è·³è¿‡è„šæœ¬æœ€å¼€å§‹è¿è¡Œçš„æ—¶å€™çš„æ£€æŸ¥è¿æ¥<br>ip_file=ip.txt            # ä¿å­˜åœ°å€ä¿¡æ¯<br>id_file=cloudflare.ids<br>log_file=cloudflare.log<br></code></pre></td></tr></table></figure>

<p>è¿™æ˜¯æœ€ç»ˆçš„<code>Shell</code>è„šæœ¬ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br></pre></td><td class="code"><pre><code class="hljs Shell"><span class="hljs-meta prompt_">#</span><span class="language-bash">!/bin/bash</span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">CHANGE THESE</span><br>cf_email_addr=&quot;&quot;  # cloudFlareæ³¨å†Œè´¦æˆ·é‚®ç®±<br>cf_global_api_key=&quot;&quot;   # ä½ çš„cloudflareè´¦æˆ·Globel API Key<br>domain_main=&quot;&quot;   # ä½ çš„ä¸»åŸŸå, å¦‚google.com<br>domain_full_ddns=&quot;&quot; # ddnsç”¨çš„å®Œæ•´åŸŸå, å¦‚ddns.google.com<br>record_type=&quot;&quot;             # A or AAAA,ipv4 æˆ– ipv6è§£æ<br><br>eth_card=&quot;&quot;             # ä½¿ç”¨æœ¬åœ°æ–¹å¼è·å–ipç»‘å®šçš„ç½‘å¡, å¦‚eth0<br>ip_index=&quot;local&quot;            # use &quot;internet&quot; or &quot;local&quot;,ä½¿ç”¨æœ¬åœ°æ–¹å¼è¿˜æ˜¯ç½‘ç»œæ–¹å¼è·å–åœ°å€<br><br>reset_ip=0 # 1ä¸ºå°†ddnsçš„ipæ”¹ä¸ºlocalhostï¼Œ2ä¸ºæ‰‹åŠ¨è¾“å…¥ipï¼Œå…¶ä»–ä»»æ„å€¼ä¸ºä¸æ˜¯<br>enable_cache=&quot;0&quot;              # 1ä¸ºä¿å­˜ç¼“å­˜æ–‡ä»¶,å…¶ä»–ä»»æ„å€¼ä¸ºä¸ä¿å­˜ã€‚ä¿å­˜ç¼“å­˜æ–‡ä»¶å¯è®©ä¸‹æ¬¡ddnsæ›´æ–°é€Ÿåº¦æ›´å¿«ï¼Œä½†ç¼“å­˜æ–‡ä»¶æ³„æ¼éœ€è¦ä½ å»æŠŠcf_global_api_keyé‡æ–°revokeä¸€æ¬¡ï¼Œä¸ç„¶ä¼šé€ æˆéšç§æ³„æ¼<br>skip_connectivity_check=&quot;0&quot; # 0ä¸ºä¸è·³è¿‡è„šæœ¬æœ€å¼€å§‹è¿è¡Œçš„æ—¶å€™çš„æ£€æŸ¥è¿æ¥<br>ip_file=&quot;ip.txt&quot;            # ä¿å­˜åœ°å€ä¿¡æ¯<br>id_file=&quot;cloudflare.ids&quot;<br>log_file=&quot;cloudflare.log&quot;<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">é»˜è®¤é…ç½®ã€‚éœ€è¦å’Œä¸Šé¢çš„å˜é‡é¡ºåºç›¸åŒ</span><br>default_config_arr=(&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;local&quot;,&quot;0&quot;,&quot;0&quot;,&quot;0&quot;,&quot;ip.txt&quot;,&quot;cloudflare.ids&quot;,&quot;cloudflare.log&quot;)<br>config_file=&quot;config.txt&quot;<br><br>create_default_config_file() &#123;<br>    echo &quot;cf_email_addr=&quot; &gt;&gt; $config_file<br>    echo &quot;cf_global_api_key=&quot; &gt;&gt; $config_file<br>    echo &quot;domain_main=&quot; &gt;&gt; $config_file<br>    echo &quot;domain_full_ddns=&quot; &gt;&gt; $config_file<br>    echo &quot;record_type=&quot; &gt;&gt; $config_file<br>    echo &quot;eth_card=&quot; &gt;&gt; $config_file<br>    echo &quot;ip_index=local&quot; &gt;&gt; $config_file<br>    echo &quot;reset_ip=0&quot; &gt;&gt; $config_file<br>    echo &quot;enable_cache=0&quot; &gt;&gt; $config_file<br>    echo &quot;skip_connectivity_check&quot; &gt;&gt; $config_file<br>    echo &quot;ip_file=ip.txt&quot; &gt;&gt; $config_file<br>    echo &quot;id_file=cloudflare.ids&quot; &gt;&gt; $config_file<br>    echo &quot;log_file=cloudflare.log&quot; &gt;&gt; $config_file<br>&#125;<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">å£°æ˜æ—¥å¿—å‡½æ•°</span><br>log() &#123;<br>    if [ &quot;$1&quot; ]; then<br>        if [ &quot;$enable_cache&quot; -eq &quot;1&quot; ]; then<br>            echo -e &quot;[$(date)] - $1&quot; &gt;&gt; $log_file<br>        fi<br>        echo &quot;[$(date)] - $1&quot;<br>    fi<br>&#125;<br>log &quot;Init config&quot;<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">åˆå§‹åŒ–é…ç½®æ–‡ä»¶</span><br><br>if [ -e &quot;$config_file&quot; ]; then<br>    log &quot;File $config_file exists.&quot;<br>else<br>    log &quot;File $config_file does not exist.&quot;<br>    create_default_config_file<br>    log &quot;è¯·å°†è¯¥é…ç½®æ–‡ä»¶å¡«å†™å®Œæˆ:$&#123;config_file&#125;&quot;<br>    exit 1<br>fi<br><br>read_config_key() &#123;<br>    key=$1<br>    value=$(grep &quot;^$&#123;key&#125;=&quot; $config_file | cut -d&#x27;=&#x27; -f2)<br>    echo $value<br>&#125;<br><br>cf_email_addr=$(read_config_key &quot;cf_email_addr&quot;)<br>cf_global_api_key=$(read_config_key &quot;cf_global_api_key&quot;)<br>domain_main=$(read_config_key &quot;domain_main&quot;)<br>domain_full_ddns=$(read_config_key &quot;domain_full_ddns&quot;)<br>record_type=$(read_config_key &quot;record_type&quot;)<br>eth_card=$(read_config_key &quot;eth_card&quot;)<br>ip_index=$(read_config_key &quot;ip_index&quot;)<br>reset_ip=$(read_config_key &quot;reset_ip&quot;)<br>enable_cache=$(read_config_key &quot;enable_cache&quot;)<br>skip_connectivity_check=$(read_config_key &quot;skip_connectivity_check&quot;)<br>ip_file=$(read_config_key &quot;ip_file&quot;)<br>id_file=$(read_config_key &quot;id_file&quot;)<br>log_file=$(read_config_key &quot;log_file&quot;)<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">æ£€æŸ¥é…ç½®æ–‡ä»¶æ˜¯å¦å­˜åœ¨ä»¥åŠæ˜¯å¦æœ‰è¿›è¡Œå¡«å†™</span><br>got_config=()<br>got_config+=$&#123;cf_email_addr&#125;<br>got_config+=$&#123;cf_global_api_key&#125;<br>got_config+=$&#123;domain_main&#125;<br>got_config+=$&#123;domain_full_ddns&#125;<br>got_config+=$&#123;record_type&#125;<br>got_config+=$&#123;eth_card&#125;<br>got_config+=$&#123;ip_index&#125;<br>got_config+=$&#123;reset_ip&#125;<br>got_config+=$&#123;enable_cache&#125;<br>got_config+=$&#123;skip_connectivity_check&#125;<br>got_config+=$&#123;ip_file&#125;<br>got_config+=$&#123;id_file&#125;<br>got_config+=$&#123;log_file&#125;<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">å°†æ•°ç»„é»˜è®¤é…ç½®è¿æ¥æˆå­—ç¬¦ä¸²</span><br>def_str=&quot;&quot;<br>for element in &quot;$&#123;default_config_arr[@]&#125;&quot;<br>do<br>    def_str=&quot;$def_str$element&quot;<br>done<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">å°†è·å–åˆ°çš„é…ç½®è¿æ¥æˆå­—ç¬¦ä¸²</span><br>got_str=&quot;&quot;<br>for element in &quot;$&#123;got_config[@]&#125;&quot;<br>do<br>    got_str=&quot;$got_str$element&quot;<br>done<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦ç›¸ç­‰,å³ç”¨æˆ·æ˜¯å¦å¡«å†™äº†é…ç½®æ–‡ä»¶</span><br>if [ &quot;$def_str&quot; = &quot;$got_str&quot; ]; then<br>    create_default_config_file<br>    log &quot;è¯·å°†è¯¥é…ç½®æ–‡ä»¶å¡«å†™å®Œæˆ:$&#123;config_file&#125;&quot;<br>fi<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">æ£€æŸ¥è¿æ¥</span><br>if [ &quot;$skip_connectivity_check&quot; -eq &quot;0&quot; ]; then<br>    log &quot;Checking connectivity to Cloudflare&quot;<br>    # æ£€æŸ¥å’Œapi.cloudflare.comçš„è¿æ¥æ€§<br>    if curl --connect-timeout 30 -s --head https://api.cloudflare.com/ &gt; /dev/null; then<br>        log &quot;Successfully connected to api.cloudflare.com&quot;<br>        # è¿æ¥æˆåŠŸï¼Œå¯ä»¥åœ¨è¿™é‡Œç»§ç»­åç»­çš„å‘½ä»¤<br>    else<br>        log &quot;Error connecting to api.cloudflare.com. Stopping script execution.&quot;<br>        exit 1<br>    fi<br>else<br>    log &quot;Skipping check connectivity to Cloudflare&quot;<br>fi<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">å¼€å§‹æ ¹æ®è¯»å–åˆ°çš„é…ç½®è¿›è¡Œddnsè®¾ç½®</span><br>log &quot;Starting DDNS&quot;<br>if [ $record_type = &quot;AAAA&quot; ];then<br>	if [ &quot;$reset_ip&quot; -eq &quot;1&quot; ]; then<br>		ip=&quot;::1&quot;<br>		log &quot;Reset DDNS address to loopback...&quot;<br>	elif [ &quot;$reset_ip&quot; -eq &quot;2&quot; ]; then<br>		read -p &quot;Please enter an AAAA record IP:\n&quot; ip<br>		log &quot;Got it, now setting DDNS...&quot;<br>	else<br>		if [ $ip_index = &quot;internet&quot; ];then<br>			ip=$(curl -6 ip.sb)<br>		elif [ $ip_index = &quot;local&quot; ];then<br>			if [ &quot;$user&quot; = &quot;root&quot; ];then<br>				ip=$(ifconfig $eth_card | grep &#x27;inet6&#x27;| grep -v &#x27;::1&#x27;|grep -v &#x27;fe80&#x27; | cut -f2 | awk &#x27;&#123; print $2&#125;&#x27; | head -1)<br>			else<br>				ip=$(/sbin/ifconfig $eth_card | grep &#x27;inet6&#x27;| grep -v &#x27;::1&#x27;|grep -v &#x27;fe80&#x27; | cut -f2 | awk &#x27;&#123; print $2&#125;&#x27; | head -1)<br>			fi<br>		else<br>			log &quot;Error IP index, please input the right type&quot;<br>			exit 0<br>		fi<br>	fi<br>elif [ $record_type = &quot;A&quot; ];then<br>	if [ &quot;$enable_cache&quot; -eq &quot;1&quot; ]; then<br>		ip=&quot;127.0.0.1&quot;<br>		log &quot;Reset DDNS address to loopback...&quot;<br>	elif [ &quot;$reset_ip&quot; -eq &quot;2&quot; ]; then<br>		read -p &quot;Please enter an A record IP:\n&quot; ip<br>		log &quot;Got it, now setting DDNS...&quot;<br>	else<br>		if [ $ip_index = &quot;internet&quot; ];then<br>			ip=$(curl -4 ip.sb)<br>		elif [ $ip_index = &quot;local&quot; ];then<br>			if [ &quot;$user&quot; = &quot;root&quot; ];then<br>				ip=$(ifconfig $eth_card | grep &#x27;inet&#x27;| grep -v &#x27;127.0.0.1&#x27; | grep -v &#x27;inet6&#x27;|cut -f2 | awk &#x27;&#123; print $2&#125;&#x27;)<br>			else<br>				ip=$(/sbin/ifconfig $eth_card | grep &#x27;inet&#x27;| grep -v &#x27;127.0.0.1&#x27; | grep -v &#x27;inet6&#x27;|cut -f2 | awk &#x27;&#123; print $2&#125;&#x27;)<br>			fi<br>		else<br>			log &quot;Error IP index, please input the right type&quot;<br>			exit 0<br>		fi<br>	fi<br>else<br>    log &quot;Error DNS type&quot;<br>    exit 0<br>fi<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">SCRIPT START</span><br>log &quot;Check Initiated&quot;<br>log &quot;Your ip is:    $&#123;ip&#125;&quot;<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">åˆ¤æ–­ipæ˜¯å¦å‘ç”Ÿå˜åŒ–</span><br>if [ &quot;$enable_cache&quot; -eq &quot;1&quot; ]; then<br>    if [ -f $ip_file ]; then<br>        old_ip=$(cat $ip_file)<br>        if [ $ip == $old_ip ]; then<br>            log &quot;IP has not changed.&quot;<br>            exit 0<br>        fi<br>    fi<br>fi<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">è·å–åŸŸåå’Œæˆæƒ</span><br><br>if [ &quot;$enable_cache&quot; -eq &quot;1&quot; ]; then<br>    if [ -f $id_file ] &amp;&amp; [ $(wc -l $id_file | cut -d &quot; &quot; -f 1) == 2 ]; then<br>        zone_identifier=$(head -1 $id_file)<br>        record_identifier=$(tail -1 $id_file)<br>    else<br>        zone_identifier=$(curl -s -X GET &quot;https://api.cloudflare.com/client/v4/zones?name=$domain_main&quot; \<br>            -H &quot;X-Auth-Email: $cf_email_addr&quot; \<br>            -H &quot;X-Auth-Key: $cf_global_api_key&quot; \<br>            -H &quot;Content-Type: application/json&quot; | grep -Po &#x27;(?&lt;=&quot;id&quot;:&quot;)[^&quot;]*&#x27; | head -1 )<br>        record_identifier=$(curl -s -X GET &quot;https://api.cloudflare.com/client/v4/zones/$zone_identifier/dns_records?type=$&#123;record_type&#125;&amp;name=$domain_full_ddns&quot; \<br>            -H &quot;X-Auth-Email: $cf_email_addr&quot; \<br>            -H &quot;X-Auth-Key: $cf_global_api_key&quot; \<br>            -H &quot;Content-Type: application/json&quot;  | grep -Po &#x27;(?&lt;=&quot;id&quot;:&quot;)[^&quot;]*&#x27;)<br>        log &quot;$zone_identifier&quot; &gt; $id_file<br>        log &quot;$record_identifier&quot; &gt;&gt; $id_file<br>    fi<br>else<br>    zone_identifier=$(curl -s -X GET &quot;https://api.cloudflare.com/client/v4/zones?name=$domain_main&quot; \<br>        -H &quot;X-Auth-Email: $cf_email_addr&quot; \<br>        -H &quot;X-Auth-Key: $cf_global_api_key&quot; \<br>        -H &quot;Content-Type: application/json&quot; | grep -Po &#x27;(?&lt;=&quot;id&quot;:&quot;)[^&quot;]*&#x27; | head -1 )<br>    record_identifier=$(curl -s -X GET &quot;https://api.cloudflare.com/client/v4/zones/$zone_identifier/dns_records?type=$&#123;record_type&#125;&amp;name=$domain_full_ddns&quot; \<br>        -H &quot;X-Auth-Email: $cf_email_addr&quot; \<br>        -H &quot;X-Auth-Key: $cf_global_api_key&quot; \<br>        -H &quot;Content-Type: application/json&quot;  | grep -Po &#x27;(?&lt;=&quot;id&quot;:&quot;)[^&quot;]*&#x27;)<br>fi<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">æ›´æ–°DNSè®°å½•</span><br>update=$(curl -s -X PUT &quot;https://api.cloudflare.com/client/v4/zones/$zone_identifier/dns_records/$record_identifier&quot; \<br>    -H &quot;X-Auth-Email: $cf_email_addr&quot; \<br>    -H &quot;X-Auth-Key: $cf_global_api_key&quot; \<br>    -H &quot;Content-Type: application/json&quot; \<br>    --data &quot;&#123;\&quot;type\&quot;:\&quot;$record_type\&quot;,\&quot;name\&quot;:\&quot;$domain_full_ddns\&quot;,\&quot;content\&quot;:\&quot;$ip\&quot;,\&quot;ttl\&quot;:1,\&quot;proxied\&quot;:false&#125;&quot;)<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">è¾“å‡ºDDNSæ›´æ–°æƒ…å†µ</span><br>if [[ $update == *&quot;\&quot;success\&quot;:true&quot;* ]]; then<br>    message=&quot;$domain_full_ddns -&gt; $ip&quot;<br>    if [ &quot;$enable_cache&quot; -eq &quot;1&quot; ]; then<br>        echo &quot;$message&quot; &gt; $ip_file<br>    fi<br>    log message<br>else<br>    message=&quot;API UPDATE FAILED. DUMPING RESULTS:\n$update&quot;<br>    log &quot;$message&quot;<br>    exit 1<br>fi<br></code></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> datetime<br><span class="hljs-keyword">import</span> platform<br><span class="hljs-keyword">import</span> subprocess<br><span class="hljs-keyword">import</span> re<br><br><span class="hljs-comment"># éœ€è¦å…ˆå®‰è£…ä»¥ä¸‹pipåŒ…æ‰èƒ½è¿è¡Œ:</span><br><span class="hljs-comment"># requests</span><br><br><span class="hljs-comment"># é…ç½®å˜é‡</span><br>cf_email_addr = <span class="hljs-string">&quot;&quot;</span>  <span class="hljs-comment"># CloudFlareæ³¨å†Œè´¦æˆ·é‚®ç®±</span><br>cf_global_api_key = <span class="hljs-string">&quot;&quot;</span>  <span class="hljs-comment"># ä½ çš„Cloudflareè´¦æˆ·Global API Key</span><br>domain_main = <span class="hljs-string">&quot;&quot;</span>  <span class="hljs-comment"># ä½ çš„ä¸»åŸŸå, å¦‚google.com</span><br>domain_full_ddns = <span class="hljs-string">&quot;&quot;</span>  <span class="hljs-comment"># ddnsç”¨çš„å®Œæ•´åŸŸå, å¦‚ddns.google.com</span><br>record_type = <span class="hljs-string">&quot;AAAA&quot;</span>  <span class="hljs-comment"># A or AAAA, ipv4 æˆ– ipv6è§£æ</span><br><br>eth_card = <span class="hljs-string">&quot;&quot;</span>  <span class="hljs-comment"># ä½¿ç”¨æœ¬åœ°æ–¹å¼è·å–IPç»‘å®šçš„ç½‘å¡, å¦‚eth0ã€‚æ­¤è®¾ç½®é¡¹åªåœ¨linuxä¸Šç”Ÿæ•ˆ</span><br>ip_index = <span class="hljs-string">&quot;local&quot;</span>  <span class="hljs-comment"># ä½¿ç”¨ &quot;internet&quot; æˆ– &quot;local&quot;, è·å–åœ°å€çš„æ–¹å¼</span><br><br>reset_ip = <span class="hljs-number">0</span> <span class="hljs-comment"># 1ä¸ºå°†ddnsçš„ipæ”¹ä¸ºlocalhostï¼Œ2ä¸ºæ‰‹åŠ¨è¾“å…¥ipï¼Œå…¶ä»–ä»»æ„å€¼ä¸ºä¸æ˜¯</span><br>enable_cache = <span class="hljs-number">0</span>  <span class="hljs-comment"># 1ä¸ºä¿å­˜ç¼“å­˜æ–‡ä»¶ï¼Œå…¶ä»–ä»»æ„å€¼ä¸ºä¸ä¿å­˜ç¼“å­˜æ–‡ä»¶</span><br>skip_connectivity_check = <span class="hljs-number">0</span> <span class="hljs-comment"># 0ä¸ºä¸è·³è¿‡è„šæœ¬æœ€å¼€å§‹è¿è¡Œçš„æ—¶å€™çš„æ£€æŸ¥è¿æ¥</span><br>ip_file = <span class="hljs-string">&quot;ip.txt&quot;</span>  <span class="hljs-comment"># ä¿å­˜åœ°å€ä¿¡æ¯çš„æ–‡ä»¶</span><br>id_file = <span class="hljs-string">&quot;cloudflare.ids&quot;</span><br>log_file = <span class="hljs-string">&quot;cloudflare.log&quot;</span><br><br><br><span class="hljs-comment"># æŒ‰ç…§è¿™ä¸ªæ ¼å¼å¡«å…¥config.txt</span><br>example_config_file = &#123;<br>  <span class="hljs-string">&quot;cf_email_addr&quot;</span>: <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-comment"># CloudFlareæ³¨å†Œè´¦æˆ·é‚®ç®±</span><br>  <span class="hljs-string">&quot;cf_global_api_key&quot;</span>: <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-comment"># ä½ çš„Cloudflareè´¦æˆ·Global API Key</span><br>  <span class="hljs-string">&quot;domain_main&quot;</span>: <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-comment"># ä½ çš„ä¸»åŸŸå, å¦‚google.com</span><br>  <span class="hljs-string">&quot;domain_full_ddns&quot;</span>: <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-comment"># ddnsç”¨çš„å®Œæ•´åŸŸå, å¦‚ddns.google.com</span><br>  <span class="hljs-string">&quot;record_type&quot;</span>: <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-comment"># A or AAAA, ipv4 æˆ– ipv6è§£æ</span><br>  <span class="hljs-string">&quot;eth_card&quot;</span>: <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-comment"># ä½¿ç”¨æœ¬åœ°æ–¹å¼è·å–IPç»‘å®šçš„ç½‘å¡, å¦‚eth0ã€‚æ­¤è®¾ç½®é¡¹åªåœ¨linuxä¸Šç”Ÿæ•ˆ</span><br>  <span class="hljs-string">&quot;ip_index&quot;</span>: <span class="hljs-string">&quot;local&quot;</span>, <span class="hljs-comment"># ä½¿ç”¨ &quot;internet&quot; æˆ– &quot;local&quot;, è·å–åœ°å€çš„æ–¹å¼ã€‚internalä¸æ”¯æŒè·å–ipv4åœ°å€</span><br>  <span class="hljs-string">&quot;reset_ip&quot;</span>: <span class="hljs-number">0</span>, <span class="hljs-comment"># 1ä¸ºå°†ddnsçš„ipæ”¹ä¸ºlocalhostï¼Œå…¶ä»–ä»»æ„å€¼ä¸ºä¸æ˜¯</span><br>  <span class="hljs-string">&quot;enable_cache&quot;</span>: <span class="hljs-number">0</span>, <span class="hljs-comment"># 1ä¸ºä¿å­˜ç¼“å­˜æ–‡ä»¶ï¼Œå…¶ä»–ä»»æ„å€¼ä¸ºä¸ä¿å­˜ç¼“å­˜æ–‡ä»¶</span><br>  <span class="hljs-string">&quot;skip_connectivity_check&quot;</span>: <span class="hljs-number">0</span>,<span class="hljs-comment"># 0ä¸ºä¸è·³è¿‡è„šæœ¬æœ€å¼€å§‹è¿è¡Œçš„æ—¶å€™çš„æ£€æŸ¥è¿æ¥</span><br>  <span class="hljs-string">&quot;ip_file&quot;</span>: <span class="hljs-string">&quot;ip.txt&quot;</span>, <span class="hljs-comment"># ä¸éœ€è¦å¡«å†™</span><br>  <span class="hljs-string">&quot;id_file&quot;</span>: <span class="hljs-string">&quot;cloudflare.ids&quot;</span>, <span class="hljs-comment"># ä¸éœ€è¦å¡«å†™</span><br>  <span class="hljs-string">&quot;log_file&quot;</span>: <span class="hljs-string">&quot;cloudflare.log&quot;</span> <span class="hljs-comment"># ä¸éœ€è¦å¡«å†™</span><br>&#125;<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">log</span>(<span class="hljs-params">message</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;æ—¥å¿—å‡½æ•°&quot;&quot;&quot;</span><br>    <span class="hljs-keyword">if</span> message:<br>        <span class="hljs-keyword">if</span> enable_cache == <span class="hljs-number">1</span>:<br>            <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(log_file, <span class="hljs-string">&#x27;a&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>                f.write(<span class="hljs-string">f&quot;[<span class="hljs-subst">&#123;datetime.datetime.now()&#125;</span>] - <span class="hljs-subst">&#123;message&#125;</span>\n&quot;</span>)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[<span class="hljs-subst">&#123;datetime.datetime.now()&#125;</span>] - <span class="hljs-subst">&#123;message&#125;</span>&quot;</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">init_value</span>():<br>    <span class="hljs-keyword">global</span> cf_email_addr, cf_global_api_key, domain_main, domain_full_ddns, record_type, eth_card, skip_connectivity_check, ip_index, reset_ip, enable_cache, ip_file, id_file, og_file<br>    config_dict = &#123;&#125;<br>    script_dir = os.path.dirname(os.path.abspath(__file__))<br>    config_path = os.path.join(script_dir, <span class="hljs-string">&quot;config.txt&quot;</span>)<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(config_path, <span class="hljs-string">&#x27;r&#x27;</span>, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>            <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> file:<br>                line = line.strip()<br>                <span class="hljs-keyword">if</span> line <span class="hljs-keyword">and</span> <span class="hljs-string">&#x27;=&#x27;</span> <span class="hljs-keyword">in</span> line:<br>                    key, value = line.split(<span class="hljs-string">&#x27;=&#x27;</span>, <span class="hljs-number">1</span>)<br>                    config_dict[key] = value<br>            common_keys = <span class="hljs-built_in">set</span>(config_dict.keys()) &amp; <span class="hljs-built_in">set</span>(example_config_file.keys())<br>            different_values = &#123;&#125;<br>            <span class="hljs-keyword">for</span> key <span class="hljs-keyword">in</span> common_keys:<br>                <span class="hljs-keyword">if</span> config_dict[key] != example_config_file[key]:<br>                    different_values[key] = (config_dict[key], example_config_file[key])<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(different_values) == <span class="hljs-number">0</span>:<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;è¯·å°†è¯¥é…ç½®æ–‡ä»¶å¡«å†™å®Œæˆ:<span class="hljs-subst">&#123;config_path&#125;</span>&quot;</span>)<br>                sys.exit()<br>            log(<span class="hljs-string">&quot;File config.txt exists.&quot;</span>)<br>            cf_email_addr = config_dict.get(<span class="hljs-string">&#x27;cf_email_addr&#x27;</span>)<br>            cf_global_api_key = config_dict.get(<span class="hljs-string">&#x27;cf_global_api_key&#x27;</span>)<br>            domain_main = config_dict.get(<span class="hljs-string">&#x27;domain_main&#x27;</span>)<br>            domain_full_ddns = config_dict.get(<span class="hljs-string">&#x27;domain_full_ddns&#x27;</span>)<br>            record_type = config_dict.get(<span class="hljs-string">&#x27;record_type&#x27;</span>)<br>            eth_card = config_dict.get(<span class="hljs-string">&#x27;eth_card&#x27;</span>)<br>            ip_index = config_dict.get(<span class="hljs-string">&#x27;ip_index&#x27;</span>)<br>            reset_ip = <span class="hljs-built_in">int</span>(config_dict.get(<span class="hljs-string">&#x27;reset_ip&#x27;</span>))<br>            enable_cache = <span class="hljs-built_in">int</span>(config_dict.get(<span class="hljs-string">&#x27;enable_cache&#x27;</span>))<br>            skip_connectivity_check = <span class="hljs-built_in">int</span>(config_dict.get(<span class="hljs-string">&#x27;skip_connectivity_check&#x27;</span>))<br>            ip_file = config_dict.get(<span class="hljs-string">&#x27;ip_file&#x27;</span>)<br>            id_file = config_dict.get(<span class="hljs-string">&#x27;id_file&#x27;</span>)<br>            log_file = config_dict.get(<span class="hljs-string">&#x27;log_file&#x27;</span>)<br>    <span class="hljs-keyword">except</span> FileNotFoundError:<br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(config_path, <span class="hljs-string">&#x27;w&#x27;</span>, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>            <span class="hljs-keyword">for</span> key, value <span class="hljs-keyword">in</span> example_config_file.items():<br>                file.write(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;key&#125;</span>=<span class="hljs-subst">&#123;value&#125;</span>\n&#x27;</span>)<br>            <span class="hljs-comment">#json.dump(example_config_file, file, ensure_ascii=False, indent=4)</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;è¯·å°†è¯¥é…ç½®æ–‡ä»¶å¡«å†™å®Œæˆ:<span class="hljs-subst">&#123;config_path&#125;</span>&quot;</span>)<br>        sys.exit()<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_ipv6_address_windows</span>():<br>    <span class="hljs-string">&quot;&quot;&quot;åœ¨Windowsä¸Šè·å–ä¸´æ—¶IPv6åœ°å€&quot;&quot;&quot;</span><br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-comment"># æ‰§è¡Œipconfigå‘½ä»¤å¹¶æ•è·è¾“å‡º</span><br>        output = subprocess.check_output([<span class="hljs-string">&quot;ipconfig&quot;</span>], text=<span class="hljs-literal">True</span>)<br>        <span class="hljs-comment"># ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æŸ¥æ‰¾ä¸´æ—¶IPv6åœ°å€</span><br>        <span class="hljs-keyword">match</span> = re.search(<span class="hljs-string">r&quot;ä¸´æ—¶ IPv6 åœ°å€.*: ([a-fA-F0-9:]+)&quot;</span>, output)<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">match</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">match</span>.group(<span class="hljs-number">1</span>)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Error: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_ipv6_address_linux</span>():<br>    <span class="hljs-string">&quot;&quot;&quot;åœ¨Linuxä¸Šè·å–Global IPv6åœ°å€&quot;&quot;&quot;</span><br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-comment"># æ‰§è¡Œip -6 addr showå‘½ä»¤å¹¶æ•è·è¾“å‡º</span><br>        output = subprocess.check_output([<span class="hljs-string">&quot;ip&quot;</span>, <span class="hljs-string">&quot;-6&quot;</span>, <span class="hljs-string">&quot;addr&quot;</span>, <span class="hljs-string">&quot;show&quot;</span>, eth_card], text=<span class="hljs-literal">True</span>)<br>        <span class="hljs-comment"># ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æŸ¥æ‰¾global scopeçš„IPv6åœ°å€</span><br>        <span class="hljs-keyword">match</span> = re.search(<span class="hljs-string">r&quot;inet6\s+([a-fA-F0-9:]+)/\d+\s+scope global&quot;</span>, output)<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">match</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">match</span>.group(<span class="hljs-number">1</span>)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Error: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_ipv6_platform</span>():<br>    <span class="hljs-keyword">if</span> platform.system() == <span class="hljs-string">&quot;Windows&quot;</span>:<br>        <span class="hljs-keyword">return</span> get_ipv6_address_windows()<br>    <span class="hljs-keyword">elif</span> platform.system() == <span class="hljs-string">&quot;Linux&quot;</span>:<br>        <span class="hljs-keyword">return</span> get_ipv6_address_linux()<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_ip</span>():<br>    <span class="hljs-string">&quot;&quot;&quot;è·å–IPåœ°å€&quot;&quot;&quot;</span><br>    <span class="hljs-keyword">if</span> record_type == <span class="hljs-string">&quot;AAAA&quot;</span>:<br>        <span class="hljs-keyword">if</span> reset_ip == <span class="hljs-number">1</span>:<br>            log(<span class="hljs-string">&quot;Reset DDNS address to loopback...&quot;</span>)<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;::1&quot;</span><br>        <span class="hljs-keyword">elif</span> reset_ip == <span class="hljs-number">2</span>:<br>            ip = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;Please enter an AAAA record IP:\n&quot;</span>)<br>            log(<span class="hljs-string">&quot;Got it, now setting DDNS...&quot;</span>)<br>            <span class="hljs-keyword">return</span> ip<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">if</span> ip_index == <span class="hljs-string">&quot;internet&quot;</span>:<br>                <span class="hljs-keyword">return</span> requests.get(<span class="hljs-string">&#x27;https://api64.ipify.org?format=json&#x27;</span>).json()[<span class="hljs-string">&#x27;ip&#x27;</span>]<br>            <span class="hljs-keyword">elif</span> ip_index == <span class="hljs-string">&quot;local&quot;</span>:<br>                <span class="hljs-keyword">return</span> get_ipv6_platform()<br>                <span class="hljs-keyword">pass</span><br>    <span class="hljs-keyword">elif</span> record_type == <span class="hljs-string">&quot;A&quot;</span>:<br>        <span class="hljs-keyword">if</span> reset_ip == <span class="hljs-number">1</span>:<br>            log(<span class="hljs-string">&quot;Reset DDNS address to loopback...&quot;</span>)<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;127.0.0.1&quot;</span><br>        <span class="hljs-keyword">elif</span> reset_ip == <span class="hljs-number">2</span>:<br>            ip = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;Please enter an A record IP:\n&quot;</span>)<br>            log(<span class="hljs-string">&quot;Got it, now setting DDNS...&quot;</span>)<br>            <span class="hljs-keyword">return</span> ip<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">if</span> ip_index == <span class="hljs-string">&quot;internet&quot;</span>:<br>                <span class="hljs-keyword">return</span> requests.get(<span class="hljs-string">&#x27;https://api.ipify.org?format=json&#x27;</span>).json()[<span class="hljs-string">&#x27;ip&#x27;</span>]<br>            <span class="hljs-keyword">elif</span> ip_index == <span class="hljs-string">&quot;local&quot;</span>:<br>                <span class="hljs-comment"># è¿™é‡Œéœ€è¦è‡ªè¡Œå®ç°æœ¬åœ°è·å–IPv4åœ°å€çš„é€»è¾‘</span><br>                <span class="hljs-keyword">pass</span><br>    <span class="hljs-keyword">else</span>:<br>        log(<span class="hljs-string">&quot;Error DNS type&quot;</span>)<br>        exit(<span class="hljs-number">0</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">update_cloudflare_dns</span>(<span class="hljs-params">ip</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;æ›´æ–°Cloudflare DNSè®°å½•&quot;&quot;&quot;</span><br>    headers = &#123;<br>        <span class="hljs-string">&quot;X-Auth-Email&quot;</span>: cf_email_addr,<br>        <span class="hljs-string">&quot;X-Auth-Key&quot;</span>: cf_global_api_key,<br>        <span class="hljs-string">&quot;Content-Type&quot;</span>: <span class="hljs-string">&quot;application/json&quot;</span>,<br>    &#125;<br>    <span class="hljs-comment"># è·å–Zone ID</span><br>    zone_response = requests.get(<span class="hljs-string">f&quot;https://api.cloudflare.com/client/v4/zones?name=<span class="hljs-subst">&#123;domain_main&#125;</span>&quot;</span>, headers=headers)<br>    zone_id = zone_response.json()[<span class="hljs-string">&#x27;result&#x27;</span>][<span class="hljs-number">0</span>][<span class="hljs-string">&#x27;id&#x27;</span>]<br><br>    <span class="hljs-comment"># è·å–DNSè®°å½•ID</span><br>    dns_response = requests.get(<span class="hljs-string">f&quot;https://api.cloudflare.com/client/v4/zones/<span class="hljs-subst">&#123;zone_id&#125;</span>/dns_records?type=<span class="hljs-subst">&#123;record_type&#125;</span>&amp;name=<span class="hljs-subst">&#123;domain_full_ddns&#125;</span>&quot;</span>, headers=headers)<br>    dns_record_id = dns_response.json()[<span class="hljs-string">&#x27;result&#x27;</span>][<span class="hljs-number">0</span>][<span class="hljs-string">&#x27;id&#x27;</span>]<br><br>    <span class="hljs-comment"># æ›´æ–°DNSè®°å½•</span><br>    data = &#123;<br>        <span class="hljs-string">&quot;type&quot;</span>: record_type,<br>        <span class="hljs-string">&quot;name&quot;</span>: domain_full_ddns,<br>        <span class="hljs-string">&quot;content&quot;</span>: ip,<br>        <span class="hljs-string">&quot;ttl&quot;</span>: <span class="hljs-number">1</span>,<br>        <span class="hljs-string">&quot;proxied&quot;</span>: <span class="hljs-literal">False</span><br>    &#125;<br>    update_response = requests.put(<span class="hljs-string">f&quot;https://api.cloudflare.com/client/v4/zones/<span class="hljs-subst">&#123;zone_id&#125;</span>/dns_records/<span class="hljs-subst">&#123;dns_record_id&#125;</span>&quot;</span>, headers=headers, json=data)<br>    <span class="hljs-keyword">return</span> update_response.json()<br><br><br><br><span class="hljs-comment"># ä¸»é€»è¾‘</span><br>log(<span class="hljs-string">&quot;Init config&quot;</span>)<br>init_value()<br>log(<span class="hljs-string">&quot;Starting DDNS&quot;</span>)<br><span class="hljs-keyword">if</span> skip_connectivity_check == <span class="hljs-number">0</span>:<br>    <span class="hljs-comment"># æ£€æŸ¥è¿æ¥æ€§</span><br>    log(<span class="hljs-string">&quot;Checking connectivity to cloudflare&quot;</span>)<br>    <span class="hljs-keyword">try</span>:<br>        response = requests.get(<span class="hljs-string">&quot;https://api.cloudflare.com&quot;</span>, timeout=<span class="hljs-number">30</span>)<br>        <span class="hljs-comment"># å¦‚æœè¯·æ±‚æˆåŠŸï¼ŒçŠ¶æ€ç ä¸º200</span><br>        <span class="hljs-keyword">if</span> response.ok:<br>            log(<span class="hljs-string">&quot;Successfully connected to https://api.cloudflare.com&quot;</span>)<br>        <span class="hljs-keyword">else</span>:<br>            log(<span class="hljs-string">&quot;Connected to https://api.cloudflare.com but received a non-success status code:&quot;</span>, response.status_code)<br>    <span class="hljs-keyword">except</span> requests.exceptions.RequestException <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-comment"># å¤„ç†è¿æ¥é”™è¯¯</span><br>        log(<span class="hljs-string">&quot;Error connecting to https://api.cloudflare.com&quot;</span>)<br>        log(e)<br>        sys.exit()<br>    <span class="hljs-keyword">except</span> requests.exceptions.Timeout:<br>        <span class="hljs-comment"># å¤„ç†è¿æ¥è¶…æ—¶</span><br>        log(<span class="hljs-string">&quot;Timeout connecting to https://api.cloudflare.com&quot;</span>)<br>        log(e)<br>        sys.exit()<br>    log(<span class="hljs-string">&quot;Check Initiated&quot;</span>)<br><span class="hljs-keyword">else</span>:<br>    log(<span class="hljs-string">&quot;Skipping check connectivity to Cloudflare&quot;</span>)<br><br><span class="hljs-comment"># è·å–IPåœ°å€</span><br>ip = get_ip()<br>log(<span class="hljs-string">f&quot;Your ip is:    <span class="hljs-subst">&#123;ip&#125;</span>&quot;</span>)<br><br><span class="hljs-comment"># åˆ¤æ–­IPæ˜¯å¦å‘ç”Ÿå˜åŒ–</span><br>old_ip = <span class="hljs-literal">None</span><br><span class="hljs-keyword">if</span> enable_cache == <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> os.path.exists(ip_file):<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(ip_file) <span class="hljs-keyword">as</span> f:<br>        old_ip = f.read().strip()<br><span class="hljs-keyword">if</span> ip == old_ip:<br>    <span class="hljs-keyword">if</span> ip == <span class="hljs-literal">None</span>:<br>        log(<span class="hljs-string">&quot;Check your Internet connection.&quot;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        log(<span class="hljs-string">&quot;IP has not changed.&quot;</span>)<br>    exit(<span class="hljs-number">0</span>)<br><br><span class="hljs-comment"># æ›´æ–°DNSè®°å½•</span><br>update_result = update_cloudflare_dns(ip)<br><span class="hljs-keyword">if</span> update_result[<span class="hljs-string">&#x27;success&#x27;</span>]:<br>    message = <span class="hljs-string">f&quot;Now <span class="hljs-subst">&#123;domain_full_ddns&#125;</span> -&gt; <span class="hljs-subst">&#123;ip&#125;</span>&quot;</span><br>    <span class="hljs-keyword">if</span> enable_cache == <span class="hljs-number">1</span>:<br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(ip_file, <span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>            f.write(message)<br>    log(message)<br><span class="hljs-keyword">else</span>:<br>    message = <span class="hljs-string">f&quot;API UPDATE FAILED. DUMPING RESULTS:\n<span class="hljs-subst">&#123;update_result&#125;</span>&quot;</span><br>    log(message)<br>    exit(<span class="hljs-number">1</span>)<br></code></pre></td></tr></table></figure>



<h1 id="Linuxè®¾å¤‡ä¸Šçš„é˜²ç«å¢™"><a href="#Linuxè®¾å¤‡ä¸Šçš„é˜²ç«å¢™" class="headerlink" title="Linuxè®¾å¤‡ä¸Šçš„é˜²ç«å¢™"></a>Linuxè®¾å¤‡ä¸Šçš„é˜²ç«å¢™</h1><p>æ—¢ç„¶æœ‰äº†å…¬ç½‘<code>ipv6</code>åœ°å€ï¼Œåˆ™ä¸éœ€è¦è·³æ¿æœºäº†ï¼Œéœ€è¦åœ¨ç»ˆç«¯ä¸Šé…ç½®é˜²ç«å¢™ã€‚</p>
<p>æˆ‘ç”¨çš„æ˜¯<code>UFW</code>ä½œä¸ºæˆ‘çš„é˜²ç«å¢™ã€‚ç›¸å…³çš„æ•™ç¨‹ç›´æ¥ä¸Š<a target="_blank" rel="noopener" href="https://wiki.archlinux.org/title/Uncomplicated_Firewall">ArchWiki</a>ç¿»ï¼Œå†™çš„å¾ˆè¯¦ç»†ã€‚<br>å…ˆå¯ç”¨<code>ipv6</code>ä¸‹çš„<code>ufw</code>ï¼šå°†<code>/etc/default/ufw</code>ä¸‹çš„<code>IPV6</code>å€¼æ”¹ä¸º<code>yes</code><br>åŸºæ“ï¼Œå…ˆç¦ä¸ª<code>Ping</code>ï¼š<br><code>ipv6</code>çš„<code>Ping</code>ï¼šå°†<code>/etc/ufw/before6.rules</code>ä¸­çš„<code>-A ufw6-before-input -p icmpv6 --icmpv6-type echo-request -j ACCEPT</code>æœ€åæ”¹ä¸º<code>DROP</code><br><code>ipv4</code>çš„<code>Ping</code>ï¼šå°†<code>/etc/ufw/before.rules</code>ä¸­çš„<code>-A ufw-before-input -p icmp --icmp-type echo-request -j ACCEPT</code>æœ€åæ”¹ä¸º<code>DROP</code><br><del><em>æ— è„‘æ–¹æ³•ï¼šæŠŠé…ç½®æ–‡ä»¶ä¸­æ‰€æœ‰æœ‰å…³<code>icmp</code>çš„<code>echo-request</code>å…¨æ”¹æˆ<code>DROP</code></em></del></p>
<p>æ”¾é€š<code>KDE Connect</code>:<br>æ ¹æ®å®˜æ–¹<a target="_blank" rel="noopener" href="https://userbase.kde.org/KDEConnect">æ–‡æ¡£</a>æ‰€å†™ï¼Œéœ€è¦æ”¾é€š1714-1764çš„<code>UDP</code>å’Œ<code>TCP</code>ç«¯å£ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs Shell">sudo ufw allow 1714:1764/udp<br>sudo ufw allow 1714:1764/tcp<br></code></pre></td></tr></table></figure>

<p>æ”¾é€š<code>Syncthing</code>:<br>ç›´æ¥æŠŠè½¯ä»¶æ·»åŠ åˆ°ç™½åå•å³å¯ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Shell">sudo ufw allow syncthing<br></code></pre></td></tr></table></figure>



<h1 id="æ›´æ–°ï¼šä½¿ç”¨åŸŸAPIå®ç°"><a href="#æ›´æ–°ï¼šä½¿ç”¨åŸŸAPIå®ç°" class="headerlink" title="æ›´æ–°ï¼šä½¿ç”¨åŸŸAPIå®ç°"></a>æ›´æ–°ï¼šä½¿ç”¨åŸŸAPIå®ç°</h1><p>è¿™ä¸ªæ˜¯é…ç½®æ–‡ä»¶ï¼ŒæŒ‰ä½ çš„å®é™…æƒ…å†µå¡«å†™ã€‚ä¸æƒ³è¦æ‰‹åŠ¨åˆ›å»ºï¼Œå…ˆè¿è¡Œæ›´æ–°è®°å½•çš„è„šæœ¬ï¼Œå¦‚æœè„šæœ¬å‘ç°æ²¡æœ‰è¿™ä¸ªæ–‡ä»¶ä¼šè‡ªåŠ¨åˆ›å»ºï¼Œè¿™é‡Œåªæ˜¯æç¤ºä½ è¿™äº›é”®å€¼å¯¹çš„æ„ä¹‰ã€‚</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs text">zone_id=ä½ çš„zoneID<br>record_id=ä½ è¦ä¿®æ”¹çš„è®°å½•çš„record_id<br>api_key=å»åˆ›å»ºä¸€ä¸ªåªæœ‰åŸŸæƒé™çš„API key,åªæˆæƒä¿®æ”¹DNSè®°å½•ï¼Œå°†API keyå¡«è¿™é‡Œ<br>domain_main=ä½ è¦ä¿®æ”¹çš„äºŒçº§åŸŸåã€‚æ¯”å¦‚ä½ ä¸»åŸŸåæ˜¯domain.comï¼Œä½ è¦ç»™sub.domain.comæ·»åŠ è§£æè®°å½•ï¼Œè¿™é‡Œå°±å¡«sub<br>proxied=false æ˜¯å¦å¯¹æ­¤è®°å½•å¯ç”¨cloudflare proxy cdnä¿æŠ¤<br>record_type=Aæˆ–è€…AAAA<br>eth_card=ä½¿ç”¨æœ¬åœ°æ–¹å¼è·å–ipç»‘å®šçš„ç½‘å¡, å¦‚eth0ã€‚æ­¤é¡¹ä»…åœ¨linuxä¸Šç”Ÿæ•ˆã€‚<br>ip_index=&quot;internet&quot; or &quot;local&quot;,ä½¿ç”¨æœ¬åœ°æ–¹å¼è¿˜æ˜¯ç½‘ç»œæ–¹å¼è·å–åœ°å€<br>reset_ip=1ä¸ºå°†ddnsçš„ipæ”¹ä¸ºlocalhostï¼Œ2ä¸ºæ‰‹åŠ¨è¾“å…¥ipï¼Œå…¶ä»–ä»»æ„å€¼ä¸ºä¸æ˜¯<br>enable_cache=1ä¸ºä¿å­˜ç¼“å­˜æ–‡ä»¶,å…¶ä»–ä»»æ„å€¼ä¸ºä¸ä¿å­˜ã€‚ä¿å­˜ç¼“å­˜æ–‡ä»¶å¯è®©ä¸‹æ¬¡ddnsæ›´æ–°é€Ÿåº¦æ›´å¿«ï¼Œä½†ç¼“å­˜æ–‡ä»¶æ³„æ¼éœ€è¦ä½ å»æŠŠcf_global_api_keyé‡æ–°revokeä¸€æ¬¡ï¼Œä¸ç„¶ä¼šé€ æˆéšç§æ³„æ¼<br>skip_connectivity_check=0ä¸ºä¸è·³è¿‡è„šæœ¬æœ€å¼€å§‹è¿è¡Œçš„æ—¶å€™çš„æ£€æŸ¥è¿æ¥<br>ip_file=ip.txt   ä¿å­˜åœ°å€ä¿¡æ¯çš„æ–‡ä»¶<br>id_file=cloudflare.ids<br>log_file=cloudflare.log<br></code></pre></td></tr></table></figure>



<p>å…ˆè·å–ä½ åŸŸä¸‹é¢æ‰€æœ‰çš„åŸŸååŠå…¶<code>record_id</code>ï¼š</p>
<blockquote>
<p>pythonç‰ˆå…¼ä»»<code>linux</code>å’Œ<code>windows</code>ï¼Œshellç‰ˆé€‚åˆæ€§èƒ½å·®çš„è®¾å¤‡ã€‚</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash">!/bin/bash</span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">å…ˆç”¨getè·å–åˆ°<span class="hljs-built_in">id</span>,ç„¶åå†å¡«å…¥é…ç½®æ–‡ä»¶</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">CHANGE THESE</span><br>zone_id=&quot;&quot;  # cloudFlareé‡ŒåŸŸåçš„zone id<br>record_id=&quot;&quot;   # ä½ è¦ä¿®æ”¹çš„äºŒçº§åŸŸåçš„record id,é€šè¿‡getè„šæœ¬è·å–<br>api_key=&quot;&quot; # ä½ çš„API key,ç”¨äºä¿®æ”¹dnsè®°å½•çš„key<br>domain_main=&quot;&quot;   # ä½ çš„ä¸»åŸŸå, å¦‚google.com<br>proxied=&quot;false&quot;	# æ˜¯å¦è¦å¯ç”¨cdnã€‚åˆæ³•å€¼åªæœ‰trueå’Œfalse<br>record_type=&quot;&quot;             # A or AAAA,ipv4 æˆ– ipv6è§£æ<br><br>eth_card=&quot;&quot;             # ä½¿ç”¨æœ¬åœ°æ–¹å¼è·å–ipç»‘å®šçš„ç½‘å¡, å¦‚eth0<br>ip_index=&quot;local&quot;            # use &quot;internet&quot; or &quot;local&quot;,ä½¿ç”¨æœ¬åœ°æ–¹å¼è¿˜æ˜¯ç½‘ç»œæ–¹å¼è·å–åœ°å€<br><br>reset_ip=0 # 1ä¸ºå°†ddnsçš„ipæ”¹ä¸ºlocalhostï¼Œ2ä¸ºæ‰‹åŠ¨è¾“å…¥ipï¼Œå…¶ä»–ä»»æ„å€¼ä¸ºä¸æ˜¯<br>enable_cache=&quot;0&quot;              # 1ä¸ºä¿å­˜ç¼“å­˜æ–‡ä»¶,å…¶ä»–ä»»æ„å€¼ä¸ºä¸ä¿å­˜ã€‚ä¿å­˜ç¼“å­˜æ–‡ä»¶å¯è®©ä¸‹æ¬¡ddnsæ›´æ–°é€Ÿåº¦æ›´å¿«ï¼Œä½†ç¼“å­˜æ–‡ä»¶æ³„æ¼éœ€è¦ä½ å»æŠŠcf_global_api_keyé‡æ–°revokeä¸€æ¬¡ï¼Œä¸ç„¶ä¼šé€ æˆéšç§æ³„æ¼<br>skip_connectivity_check=&quot;0&quot; # 0ä¸ºä¸è·³è¿‡è„šæœ¬æœ€å¼€å§‹è¿è¡Œçš„æ—¶å€™çš„æ£€æŸ¥è¿æ¥<br>ip_file=&quot;ip.txt&quot;            # ä¿å­˜åœ°å€ä¿¡æ¯<br>id_file=&quot;cloudflare.ids&quot;<br>log_file=&quot;cloudflare.log&quot;<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">é»˜è®¤é…ç½®ã€‚éœ€è¦å’Œä¸Šé¢çš„å˜é‡é¡ºåºç›¸åŒ</span><br>default_config_arr=(&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;false&quot;,&quot;&quot;,&quot;&quot;,&quot;local&quot;,&quot;0&quot;,&quot;0&quot;,&quot;0&quot;,&quot;ip.txt&quot;,&quot;cloudflare.ids&quot;,&quot;cloudflare.log&quot;)<br>config_file=&quot;config.txt&quot;<br><br>create_default_config_file() &#123;<br>    echo &quot;zone_id=&quot; &gt;&gt; $config_file<br>    echo &quot;record_id=&quot; &gt;&gt; $config_file<br>    echo &quot;api_key=&quot; &gt;&gt; $config_file<br>    echo &quot;domain_main=&quot; &gt;&gt; $config_file<br>    echo &quot;proxied=&quot; &gt;&gt; $config_file<br>    echo &quot;record_type=&quot; &gt;&gt; $config_file<br>    echo &quot;eth_card=&quot; &gt;&gt; $config_file<br>    echo &quot;ip_index=local&quot; &gt;&gt; $config_file<br>    echo &quot;reset_ip=0&quot; &gt;&gt; $config_file<br>    echo &quot;enable_cache=0&quot; &gt;&gt; $config_file<br>    echo &quot;skip_connectivity_check&quot; &gt;&gt; $config_file<br>    echo &quot;ip_file=ip.txt&quot; &gt;&gt; $config_file<br>    echo &quot;id_file=cloudflare.ids&quot; &gt;&gt; $config_file<br>    echo &quot;log_file=cloudflare.log&quot; &gt;&gt; $config_file<br>&#125;<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">å£°æ˜æ—¥å¿—å‡½æ•°</span><br>log() &#123;<br>    if [ &quot;$1&quot; ]; then<br>        if [ &quot;$enable_cache&quot; -eq &quot;1&quot; ]; then<br>            echo -e &quot;[$(date)] - $1&quot; &gt;&gt; $log_file<br>        fi<br>        echo &quot;[$(date)] - $1&quot;<br>    fi<br>&#125;<br>log &quot;Init config&quot;<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">åˆå§‹åŒ–é…ç½®æ–‡ä»¶</span><br><br>if [ -e &quot;$config_file&quot; ]; then<br>    log &quot;File $config_file exists.&quot;<br>else<br>    log &quot;File $config_file does not exist.&quot;<br>    create_default_config_file<br>    log &quot;è¯·å°†è¯¥é…ç½®æ–‡ä»¶å¡«å†™å®Œæˆ:$&#123;config_file&#125;&quot;<br>    exit 1<br>fi<br><br>read_config_key() &#123;<br>    key=$1<br>    value=$(grep &quot;^$&#123;key&#125;=&quot; $config_file | cut -d&#x27;=&#x27; -f2)<br>    echo $value<br>&#125;<br><br>zone_id=$(read_config_key &quot;zone_id&quot;)<br>record_id=$(read_config_key &quot;record_id&quot;)<br>api_key=$(read_config_key &quot;api_key&quot;)<br>domain_main=$(read_config_key &quot;domain_main&quot;)<br>proxied=$(read_config_key &quot;proxied&quot;)<br>record_type=$(read_config_key &quot;record_type&quot;)<br>eth_card=$(read_config_key &quot;eth_card&quot;)<br>ip_index=$(read_config_key &quot;ip_index&quot;)<br>reset_ip=$(read_config_key &quot;reset_ip&quot;)<br>enable_cache=$(read_config_key &quot;enable_cache&quot;)<br>skip_connectivity_check=$(read_config_key &quot;skip_connectivity_check&quot;)<br>ip_file=$(read_config_key &quot;ip_file&quot;)<br>id_file=$(read_config_key &quot;id_file&quot;)<br>log_file=$(read_config_key &quot;log_file&quot;)<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">æ£€æŸ¥é…ç½®æ–‡ä»¶æ˜¯å¦å­˜åœ¨ä»¥åŠæ˜¯å¦æœ‰è¿›è¡Œå¡«å†™</span><br>got_config=()<br>got_config+=$&#123;zone_id&#125;<br>got_config+=$&#123;record_id&#125;<br>got_config+=$&#123;api_key&#125;<br>got_config+=$&#123;domain_main&#125;<br>got_config+=$&#123;proxied&#125;<br>got_config+=$&#123;record_type&#125;<br>got_config+=$&#123;eth_card&#125;<br>got_config+=$&#123;ip_index&#125;<br>got_config+=$&#123;reset_ip&#125;<br>got_config+=$&#123;enable_cache&#125;<br>got_config+=$&#123;skip_connectivity_check&#125;<br>got_config+=$&#123;ip_file&#125;<br>got_config+=$&#123;id_file&#125;<br>got_config+=$&#123;log_file&#125;<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">å°†æ•°ç»„é»˜è®¤é…ç½®è¿æ¥æˆå­—ç¬¦ä¸²</span><br>def_str=&quot;&quot;<br>for element in &quot;$&#123;default_config_arr[@]&#125;&quot;<br>do<br>    def_str=&quot;$def_str$element&quot;<br>done<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">å°†è·å–åˆ°çš„é…ç½®è¿æ¥æˆå­—ç¬¦ä¸²</span><br>got_str=&quot;&quot;<br>for element in &quot;$&#123;got_config[@]&#125;&quot;<br>do<br>    got_str=&quot;$got_str$element&quot;<br>done<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦ç›¸ç­‰,å³ç”¨æˆ·æ˜¯å¦å¡«å†™äº†é…ç½®æ–‡ä»¶</span><br>if [ &quot;$def_str&quot; = &quot;$got_str&quot; ]; then<br>    create_default_config_file<br>    log &quot;è¯·å°†è¯¥é…ç½®æ–‡ä»¶å¡«å†™å®Œæˆ:$&#123;config_file&#125;&quot;<br>fi<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">æ£€æŸ¥è¿æ¥</span><br>if [ &quot;$skip_connectivity_check&quot; -eq &quot;0&quot; ]; then<br>    log &quot;Checking connectivity to Cloudflare&quot;<br>    # æ£€æŸ¥å’Œapi.cloudflare.comçš„è¿æ¥æ€§<br>    if curl --connect-timeout 30 -s --head https://api.cloudflare.com/ &gt; /dev/null; then<br>        log &quot;Successfully connected to api.cloudflare.com&quot;<br>        # è¿æ¥æˆåŠŸï¼Œå¯ä»¥åœ¨è¿™é‡Œç»§ç»­åç»­çš„å‘½ä»¤<br>    else<br>        log &quot;Error connecting to api.cloudflare.com. Stopping script execution.&quot;<br>        exit 1<br>    fi<br>else<br>    log &quot;Skipping check connectivity to Cloudflare&quot;<br>fi<br><br><br>curl --request GET \<br>  --url &quot;https://api.cloudflare.com/client/v4/zones/$zone_id/dns_records&quot; \<br>  --header &#x27;Content-Type: application/json&#x27; \<br>  --header &quot;Authorization: Bearer $api_key&quot;<br></code></pre></td></tr></table></figure>



<p>è¿™æ˜¯pythonç‰ˆçš„ï¼š</p>
<blockquote>
<p>pythonç‰ˆå…¼ä»»<code>linux</code>å’Œ<code>windows</code>ï¼Œshellç‰ˆé€‚åˆæ€§èƒ½å·®çš„è®¾å¤‡ã€‚</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> datetime<br><span class="hljs-keyword">import</span> platform<br><span class="hljs-keyword">import</span> subprocess<br><span class="hljs-keyword">import</span> re<br><br><span class="hljs-comment"># éœ€è¦å…ˆå®‰è£…ä»¥ä¸‹pipåŒ…æ‰èƒ½è¿è¡Œ:</span><br><span class="hljs-comment"># requests</span><br><br><span class="hljs-comment"># é…ç½®å˜é‡</span><br>zone_id=<span class="hljs-string">&quot;&quot;</span>  <span class="hljs-comment"># cloudFlareé‡ŒåŸŸåçš„zone id</span><br>record_id=<span class="hljs-string">&quot;&quot;</span>   <span class="hljs-comment"># ä½ è¦ä¿®æ”¹çš„äºŒçº§åŸŸåçš„record id,é€šè¿‡getè„šæœ¬è·å–</span><br>api_key=<span class="hljs-string">&quot;&quot;</span> <span class="hljs-comment"># ä½ çš„API key,ç”¨äºä¿®æ”¹dnsè®°å½•çš„key</span><br>domain_main=<span class="hljs-string">&quot;&quot;</span>   <span class="hljs-comment"># ä½ çš„ä¸»åŸŸå, å¦‚google.com</span><br>proxied=<span class="hljs-string">&quot;false&quot;</span>	<span class="hljs-comment"># æ˜¯å¦è¦å¯ç”¨cdnã€‚åˆæ³•å€¼åªæœ‰trueå’Œfalse</span><br>record_type = <span class="hljs-string">&quot;AAAA&quot;</span>  <span class="hljs-comment"># A or AAAA, ipv4 æˆ– ipv6è§£æ</span><br><br>eth_card = <span class="hljs-string">&quot;&quot;</span>  <span class="hljs-comment"># ä½¿ç”¨æœ¬åœ°æ–¹å¼è·å–IPç»‘å®šçš„ç½‘å¡, å¦‚eth0ã€‚æ­¤è®¾ç½®é¡¹åªåœ¨linuxä¸Šç”Ÿæ•ˆ</span><br>ip_index = <span class="hljs-string">&quot;local&quot;</span>  <span class="hljs-comment"># ä½¿ç”¨ &quot;internet&quot; æˆ– &quot;local&quot;, è·å–åœ°å€çš„æ–¹å¼</span><br><br>reset_ip = <span class="hljs-number">0</span> <span class="hljs-comment"># 1ä¸ºå°†ddnsçš„ipæ”¹ä¸ºlocalhostï¼Œ2ä¸ºæ‰‹åŠ¨è¾“å…¥ipï¼Œå…¶ä»–ä»»æ„å€¼ä¸ºä¸æ˜¯</span><br>enable_cache = <span class="hljs-number">0</span>  <span class="hljs-comment"># 1ä¸ºä¿å­˜ç¼“å­˜æ–‡ä»¶ï¼Œå…¶ä»–ä»»æ„å€¼ä¸ºä¸ä¿å­˜ç¼“å­˜æ–‡ä»¶</span><br>skip_connectivity_check = <span class="hljs-number">0</span> <span class="hljs-comment"># 0ä¸ºä¸è·³è¿‡è„šæœ¬æœ€å¼€å§‹è¿è¡Œçš„æ—¶å€™çš„æ£€æŸ¥è¿æ¥</span><br>ip_file = <span class="hljs-string">&quot;ip.txt&quot;</span>  <span class="hljs-comment"># ä¿å­˜åœ°å€ä¿¡æ¯çš„æ–‡ä»¶</span><br>id_file = <span class="hljs-string">&quot;cloudflare.ids&quot;</span><br>log_file = <span class="hljs-string">&quot;cloudflare.log&quot;</span><br><br><br><span class="hljs-comment"># æŒ‰ç…§è¿™ä¸ªæ ¼å¼å¡«å…¥config.txt</span><br>example_config_file = &#123;<br>  <span class="hljs-string">&quot;zone_id&quot;</span>: <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-comment"># cloudFlareé‡ŒåŸŸåçš„zone id</span><br>  <span class="hljs-string">&quot;record_id&quot;</span>: <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-comment"># ä½ è¦ä¿®æ”¹çš„äºŒçº§åŸŸåçš„record id,é€šè¿‡getè„šæœ¬è·å–</span><br>  <span class="hljs-string">&quot;api_key&quot;</span>: <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-comment"># ä½ çš„API key,ç”¨äºä¿®æ”¹dnsè®°å½•çš„key</span><br>  <span class="hljs-string">&quot;domain_main&quot;</span>: <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-comment"># ä½ çš„ä¸»åŸŸå, å¦‚google.com</span><br>  <span class="hljs-string">&quot;proxied&quot;</span>: <span class="hljs-string">&quot;false&quot;</span>, <span class="hljs-comment"># æ˜¯å¦è¦å¯ç”¨cdnã€‚åˆæ³•å€¼åªæœ‰trueå’Œfalse</span><br>  <span class="hljs-string">&quot;record_type&quot;</span>: <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-comment"># A or AAAA, ipv4 æˆ– ipv6è§£æ</span><br>  <span class="hljs-string">&quot;eth_card&quot;</span>: <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-comment"># ä½¿ç”¨æœ¬åœ°æ–¹å¼è·å–IPç»‘å®šçš„ç½‘å¡, å¦‚eth0ã€‚æ­¤è®¾ç½®é¡¹åªåœ¨linuxä¸Šç”Ÿæ•ˆ</span><br>  <span class="hljs-string">&quot;ip_index&quot;</span>: <span class="hljs-string">&quot;local&quot;</span>, <span class="hljs-comment"># ä½¿ç”¨ &quot;internet&quot; æˆ– &quot;local&quot;, è·å–åœ°å€çš„æ–¹å¼ã€‚internalä¸æ”¯æŒè·å–ipv4åœ°å€</span><br>  <span class="hljs-string">&quot;reset_ip&quot;</span>: <span class="hljs-number">0</span>, <span class="hljs-comment"># 1ä¸ºå°†ddnsçš„ipæ”¹ä¸ºlocalhostï¼Œå…¶ä»–ä»»æ„å€¼ä¸ºä¸æ˜¯</span><br>  <span class="hljs-string">&quot;enable_cache&quot;</span>: <span class="hljs-number">0</span>, <span class="hljs-comment"># 1ä¸ºä¿å­˜ç¼“å­˜æ–‡ä»¶ï¼Œå…¶ä»–ä»»æ„å€¼ä¸ºä¸ä¿å­˜ç¼“å­˜æ–‡ä»¶</span><br>  <span class="hljs-string">&quot;skip_connectivity_check&quot;</span>: <span class="hljs-number">0</span>,<span class="hljs-comment"># 0ä¸ºä¸è·³è¿‡è„šæœ¬æœ€å¼€å§‹è¿è¡Œçš„æ—¶å€™çš„æ£€æŸ¥è¿æ¥</span><br>  <span class="hljs-string">&quot;ip_file&quot;</span>: <span class="hljs-string">&quot;ip.txt&quot;</span>, <span class="hljs-comment"># ä¸éœ€è¦å¡«å†™</span><br>  <span class="hljs-string">&quot;id_file&quot;</span>: <span class="hljs-string">&quot;cloudflare.ids&quot;</span>, <span class="hljs-comment"># ä¸éœ€è¦å¡«å†™</span><br>  <span class="hljs-string">&quot;log_file&quot;</span>: <span class="hljs-string">&quot;cloudflare.log&quot;</span> <span class="hljs-comment"># ä¸éœ€è¦å¡«å†™</span><br>&#125;<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">log</span>(<span class="hljs-params">message</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;æ—¥å¿—å‡½æ•°&quot;&quot;&quot;</span><br>    <span class="hljs-keyword">if</span> message:<br>        <span class="hljs-keyword">if</span> enable_cache == <span class="hljs-number">1</span>:<br>            <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(log_file, <span class="hljs-string">&#x27;a&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>                f.write(<span class="hljs-string">f&quot;[<span class="hljs-subst">&#123;datetime.datetime.now()&#125;</span>] - <span class="hljs-subst">&#123;message&#125;</span>\n&quot;</span>)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[<span class="hljs-subst">&#123;datetime.datetime.now()&#125;</span>] - <span class="hljs-subst">&#123;message&#125;</span>&quot;</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">init_value</span>():<br>    <span class="hljs-keyword">global</span> zone_id, record_id, api_key, domain_main, proxied, record_type, eth_card, skip_connectivity_check, ip_index, reset_ip, enable_cache, ip_file, id_file, og_file<br>    config_dict = &#123;&#125;<br>    script_dir = os.path.dirname(os.path.abspath(__file__))<br>    config_path = os.path.join(script_dir, <span class="hljs-string">&quot;config.txt&quot;</span>)<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(config_path, <span class="hljs-string">&#x27;r&#x27;</span>, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>            <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> file:<br>                line = line.strip()<br>                <span class="hljs-keyword">if</span> line <span class="hljs-keyword">and</span> <span class="hljs-string">&#x27;=&#x27;</span> <span class="hljs-keyword">in</span> line:<br>                    key, value = line.split(<span class="hljs-string">&#x27;=&#x27;</span>, <span class="hljs-number">1</span>)<br>                    config_dict[key] = value<br>            common_keys = <span class="hljs-built_in">set</span>(config_dict.keys()) &amp; <span class="hljs-built_in">set</span>(example_config_file.keys())<br>            different_values = &#123;&#125;<br>            <span class="hljs-keyword">for</span> key <span class="hljs-keyword">in</span> common_keys:<br>                <span class="hljs-keyword">if</span> config_dict[key] != example_config_file[key]:<br>                    different_values[key] = (config_dict[key], example_config_file[key])<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(different_values) == <span class="hljs-number">0</span>:<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;è¯·å°†è¯¥é…ç½®æ–‡ä»¶å¡«å†™å®Œæˆ:<span class="hljs-subst">&#123;config_path&#125;</span>&quot;</span>)<br>                sys.exit()<br>            log(<span class="hljs-string">&quot;File config.txt exists.&quot;</span>)<br>            zone_id = config_dict.get(<span class="hljs-string">&#x27;zone_id&#x27;</span>)<br>            record_id = config_dict.get(<span class="hljs-string">&#x27;record_id&#x27;</span>)<br>            api_key = config_dict.get(<span class="hljs-string">&#x27;api_key&#x27;</span>)<br>            domain_main = config_dict.get(<span class="hljs-string">&#x27;domain_main&#x27;</span>)<br>            proxied = config_dict.get(<span class="hljs-string">&#x27;proxied&#x27;</span>)<br>            record_type = config_dict.get(<span class="hljs-string">&#x27;record_type&#x27;</span>)<br>            eth_card = config_dict.get(<span class="hljs-string">&#x27;eth_card&#x27;</span>)<br>            ip_index = config_dict.get(<span class="hljs-string">&#x27;ip_index&#x27;</span>)<br>            reset_ip = <span class="hljs-built_in">int</span>(config_dict.get(<span class="hljs-string">&#x27;reset_ip&#x27;</span>))<br>            enable_cache = <span class="hljs-built_in">int</span>(config_dict.get(<span class="hljs-string">&#x27;enable_cache&#x27;</span>))<br>            skip_connectivity_check = <span class="hljs-built_in">int</span>(config_dict.get(<span class="hljs-string">&#x27;skip_connectivity_check&#x27;</span>))<br>            ip_file = config_dict.get(<span class="hljs-string">&#x27;ip_file&#x27;</span>)<br>            id_file = config_dict.get(<span class="hljs-string">&#x27;id_file&#x27;</span>)<br>            log_file = config_dict.get(<span class="hljs-string">&#x27;log_file&#x27;</span>)<br>    <span class="hljs-keyword">except</span> FileNotFoundError:<br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(config_path, <span class="hljs-string">&#x27;w&#x27;</span>, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>            <span class="hljs-keyword">for</span> key, value <span class="hljs-keyword">in</span> example_config_file.items():<br>                file.write(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;key&#125;</span>=<span class="hljs-subst">&#123;value&#125;</span>\n&#x27;</span>)<br>            <span class="hljs-comment">#json.dump(example_config_file, file, ensure_ascii=False, indent=4)</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;è¯·å°†è¯¥é…ç½®æ–‡ä»¶å¡«å†™å®Œæˆ:<span class="hljs-subst">&#123;config_path&#125;</span>&quot;</span>)<br>        sys.exit()<br><br><br><br><span class="hljs-string">&quot;&quot;&quot;æ›´æ–°Cloudflare DNSè®°å½•&quot;&quot;&quot;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_cloudflare_dns</span>():    <br>    headers = &#123;<br>        <span class="hljs-string">&quot;Authorization&quot;</span>: <span class="hljs-string">&quot;Bearer &quot;</span> + api_key,<br>        <span class="hljs-string">&quot;Content-Type&quot;</span>: <span class="hljs-string">&quot;application/json&quot;</span>,<br>    &#125;<br>    update_response = requests.get(<span class="hljs-string">&quot;https://api.cloudflare.com/client/v4/zones/&quot;</span> + zone_id + <span class="hljs-string">&quot;/dns_records&quot;</span>, headers=headers)<br>    <span class="hljs-built_in">print</span>(update_response.json())<br><br><br><br><span class="hljs-comment"># ä¸»é€»è¾‘</span><br>log(<span class="hljs-string">&quot;Init config&quot;</span>)<br>init_value()<br>get_cloudflare_dns()<br></code></pre></td></tr></table></figure>



<p>è®°ä½ä½ çš„<code>zone_id</code>å’Œ<code>record_id</code>ï¼Œå¡«å…¥é…ç½®æ–‡ä»¶ä¸­ï¼Œç„¶åä½¿ç”¨ä¸‹é¢çš„è„šæœ¬æ›´æ–°è§£æè®°å½•ï¼š</p>
<blockquote>
<p>pythonç‰ˆå…¼ä»»<code>linux</code>å’Œ<code>windows</code>ï¼Œshellç‰ˆé€‚åˆæ€§èƒ½å·®çš„è®¾å¤‡ã€‚</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash">!/bin/bash</span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">å…ˆç”¨getè·å–åˆ°<span class="hljs-built_in">id</span>,ç„¶åå†å¡«å…¥é…ç½®æ–‡ä»¶</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">CHANGE THESE</span><br>zone_id=&quot;&quot;  # cloudFlareé‡ŒåŸŸåçš„zone id<br>record_id=&quot;&quot;   # ä½ è¦ä¿®æ”¹çš„äºŒçº§åŸŸåçš„record id,é€šè¿‡getè„šæœ¬è·å–<br>api_key=&quot;&quot; # ä½ çš„API key,ç”¨äºä¿®æ”¹dnsè®°å½•çš„key<br>domain_main=&quot;&quot;   # ä½ çš„ä¸»åŸŸå, å¦‚google.com<br>proxied=&quot;false&quot;	# æ˜¯å¦è¦å¯ç”¨cdnã€‚åˆæ³•å€¼åªæœ‰trueå’Œfalse<br>record_type=&quot;&quot;             # A or AAAA,ipv4 æˆ– ipv6è§£æ<br><br>eth_card=&quot;&quot;             # ä½¿ç”¨æœ¬åœ°æ–¹å¼è·å–ipç»‘å®šçš„ç½‘å¡, å¦‚eth0<br>ip_index=&quot;local&quot;            # use &quot;internet&quot; or &quot;local&quot;,ä½¿ç”¨æœ¬åœ°æ–¹å¼è¿˜æ˜¯ç½‘ç»œæ–¹å¼è·å–åœ°å€<br><br>reset_ip=0 # 1ä¸ºå°†ddnsçš„ipæ”¹ä¸ºlocalhostï¼Œ2ä¸ºæ‰‹åŠ¨è¾“å…¥ipï¼Œå…¶ä»–ä»»æ„å€¼ä¸ºä¸æ˜¯<br>enable_cache=&quot;0&quot;              # 1ä¸ºä¿å­˜ç¼“å­˜æ–‡ä»¶,å…¶ä»–ä»»æ„å€¼ä¸ºä¸ä¿å­˜ã€‚ä¿å­˜ç¼“å­˜æ–‡ä»¶å¯è®©ä¸‹æ¬¡ddnsæ›´æ–°é€Ÿåº¦æ›´å¿«ï¼Œä½†ç¼“å­˜æ–‡ä»¶æ³„æ¼éœ€è¦ä½ å»æŠŠcf_global_api_keyé‡æ–°revokeä¸€æ¬¡ï¼Œä¸ç„¶ä¼šé€ æˆéšç§æ³„æ¼<br>skip_connectivity_check=&quot;0&quot; # 0ä¸ºä¸è·³è¿‡è„šæœ¬æœ€å¼€å§‹è¿è¡Œçš„æ—¶å€™çš„æ£€æŸ¥è¿æ¥<br>ip_file=&quot;ip.txt&quot;            # ä¿å­˜åœ°å€ä¿¡æ¯<br>id_file=&quot;cloudflare.ids&quot;<br>log_file=&quot;cloudflare.log&quot;<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">é»˜è®¤é…ç½®ã€‚éœ€è¦å’Œä¸Šé¢çš„å˜é‡é¡ºåºç›¸åŒ</span><br>default_config_arr=(&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;false&quot;,&quot;&quot;,&quot;&quot;,&quot;local&quot;,&quot;0&quot;,&quot;0&quot;,&quot;0&quot;,&quot;ip.txt&quot;,&quot;cloudflare.ids&quot;,&quot;cloudflare.log&quot;)<br>config_file=&quot;config.txt&quot;<br><br>create_default_config_file() &#123;<br>    echo &quot;zone_id=&quot; &gt;&gt; $config_file<br>    echo &quot;record_id=&quot; &gt;&gt; $config_file<br>    echo &quot;api_key=&quot; &gt;&gt; $config_file<br>    echo &quot;domain_main=&quot; &gt;&gt; $config_file<br>    echo &quot;proxied=&quot; &gt;&gt; $config_file<br>    echo &quot;record_type=&quot; &gt;&gt; $config_file<br>    echo &quot;eth_card=&quot; &gt;&gt; $config_file<br>    echo &quot;ip_index=local&quot; &gt;&gt; $config_file<br>    echo &quot;reset_ip=0&quot; &gt;&gt; $config_file<br>    echo &quot;enable_cache=0&quot; &gt;&gt; $config_file<br>    echo &quot;skip_connectivity_check&quot; &gt;&gt; $config_file<br>    echo &quot;ip_file=ip.txt&quot; &gt;&gt; $config_file<br>    echo &quot;id_file=cloudflare.ids&quot; &gt;&gt; $config_file<br>    echo &quot;log_file=cloudflare.log&quot; &gt;&gt; $config_file<br>&#125;<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">å£°æ˜æ—¥å¿—å‡½æ•°</span><br>log() &#123;<br>    if [ &quot;$1&quot; ]; then<br>        if [ &quot;$enable_cache&quot; -eq &quot;1&quot; ]; then<br>            echo -e &quot;[$(date)] - $1&quot; &gt;&gt; $log_file<br>        fi<br>        echo &quot;[$(date)] - $1&quot;<br>    fi<br>&#125;<br>log &quot;Init config&quot;<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">åˆå§‹åŒ–é…ç½®æ–‡ä»¶</span><br><br>if [ -e &quot;$config_file&quot; ]; then<br>    log &quot;File $config_file exists.&quot;<br>else<br>    log &quot;File $config_file does not exist.&quot;<br>    create_default_config_file<br>    log &quot;è¯·å°†è¯¥é…ç½®æ–‡ä»¶å¡«å†™å®Œæˆ:$&#123;config_file&#125;&quot;<br>    exit 1<br>fi<br><br>read_config_key() &#123;<br>    key=$1<br>    value=$(grep &quot;^$&#123;key&#125;=&quot; $config_file | cut -d&#x27;=&#x27; -f2)<br>    echo $value<br>&#125;<br><br>zone_id=$(read_config_key &quot;zone_id&quot;)<br>record_id=$(read_config_key &quot;record_id&quot;)<br>api_key=$(read_config_key &quot;api_key&quot;)<br>domain_main=$(read_config_key &quot;domain_main&quot;)<br>proxied=$(read_config_key &quot;proxied&quot;)<br>record_type=$(read_config_key &quot;record_type&quot;)<br>eth_card=$(read_config_key &quot;eth_card&quot;)<br>ip_index=$(read_config_key &quot;ip_index&quot;)<br>reset_ip=$(read_config_key &quot;reset_ip&quot;)<br>enable_cache=$(read_config_key &quot;enable_cache&quot;)<br>skip_connectivity_check=$(read_config_key &quot;skip_connectivity_check&quot;)<br>ip_file=$(read_config_key &quot;ip_file&quot;)<br>id_file=$(read_config_key &quot;id_file&quot;)<br>log_file=$(read_config_key &quot;log_file&quot;)<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">æ£€æŸ¥é…ç½®æ–‡ä»¶æ˜¯å¦å­˜åœ¨ä»¥åŠæ˜¯å¦æœ‰è¿›è¡Œå¡«å†™</span><br>got_config=()<br>got_config+=$&#123;zone_id&#125;<br>got_config+=$&#123;record_id&#125;<br>got_config+=$&#123;api_key&#125;<br>got_config+=$&#123;domain_main&#125;<br>got_config+=$&#123;proxied&#125;<br>got_config+=$&#123;record_type&#125;<br>got_config+=$&#123;eth_card&#125;<br>got_config+=$&#123;ip_index&#125;<br>got_config+=$&#123;reset_ip&#125;<br>got_config+=$&#123;enable_cache&#125;<br>got_config+=$&#123;skip_connectivity_check&#125;<br>got_config+=$&#123;ip_file&#125;<br>got_config+=$&#123;id_file&#125;<br>got_config+=$&#123;log_file&#125;<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">å°†æ•°ç»„é»˜è®¤é…ç½®è¿æ¥æˆå­—ç¬¦ä¸²</span><br>def_str=&quot;&quot;<br>for element in &quot;$&#123;default_config_arr[@]&#125;&quot;<br>do<br>    def_str=&quot;$def_str$element&quot;<br>done<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">å°†è·å–åˆ°çš„é…ç½®è¿æ¥æˆå­—ç¬¦ä¸²</span><br>got_str=&quot;&quot;<br>for element in &quot;$&#123;got_config[@]&#125;&quot;<br>do<br>    got_str=&quot;$got_str$element&quot;<br>done<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦ç›¸ç­‰,å³ç”¨æˆ·æ˜¯å¦å¡«å†™äº†é…ç½®æ–‡ä»¶</span><br>if [ &quot;$def_str&quot; = &quot;$got_str&quot; ]; then<br>    create_default_config_file<br>    log &quot;è¯·å°†è¯¥é…ç½®æ–‡ä»¶å¡«å†™å®Œæˆ:$&#123;config_file&#125;&quot;<br>fi<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">æ£€æŸ¥è¿æ¥</span><br>if [ &quot;$skip_connectivity_check&quot; -eq &quot;0&quot; ]; then<br>    log &quot;Checking connectivity to Cloudflare&quot;<br>    # æ£€æŸ¥å’Œapi.cloudflare.comçš„è¿æ¥æ€§<br>    if curl --connect-timeout 30 -s --head https://api.cloudflare.com/ &gt; /dev/null; then<br>        log &quot;Successfully connected to api.cloudflare.com&quot;<br>        # è¿æ¥æˆåŠŸï¼Œå¯ä»¥åœ¨è¿™é‡Œç»§ç»­åç»­çš„å‘½ä»¤<br>    else<br>        log &quot;Error connecting to api.cloudflare.com. Stopping script execution.&quot;<br>        exit 1<br>    fi<br>else<br>    log &quot;Skipping check connectivity to Cloudflare&quot;<br>fi<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">å¼€å§‹æ ¹æ®è¯»å–åˆ°çš„é…ç½®è¿›è¡Œddnsè®¾ç½®</span><br>log &quot;Starting DDNS&quot;<br>if [ $record_type = &quot;AAAA&quot; ];then<br>	if [ &quot;$reset_ip&quot; -eq &quot;1&quot; ]; then<br>		ip=&quot;::1&quot;<br>		log &quot;Reset DDNS address to loopback...&quot;<br>	elif [ &quot;$reset_ip&quot; -eq &quot;2&quot; ]; then<br>		read -p &quot;Please enter an AAAA record IP:\n&quot; ip<br>		log &quot;Got it, now setting DDNS...&quot;<br>	else<br>		if [ $ip_index = &quot;internet&quot; ];then<br>			ip=$(curl -6 ip.sb)<br>		elif [ $ip_index = &quot;local&quot; ];then<br>			if [ &quot;$user&quot; = &quot;root&quot; ];then<br>				# ip=$(ifconfig $eth_card | grep &#x27;inet6&#x27;| grep -v &#x27;::1&#x27;|grep -v &#x27;fe80&#x27; | cut -f2 | awk &#x27;&#123; print $2&#125;&#x27; | head -1)<br>				ip=$(ifconfig $eth_card | awk &#x27;/inet6 24/&#x27; | awk &#x27;&#123;print $2&#125;&#x27; | head -1)<br>			else<br>				ip=$(/sbin/ifconfig $eth_card | grep &#x27;inet6&#x27;| grep -v &#x27;::1&#x27;|grep -v &#x27;fe80&#x27; | cut -f2 | awk &#x27;&#123; print $2&#125;&#x27; | head -1)<br>			fi<br>		else<br>			log &quot;Error IP index, please input the right type&quot;<br>			exit 0<br>		fi<br>	fi<br>elif [ $record_type = &quot;A&quot; ];then<br>	if [ &quot;$reset_ip&quot; -eq &quot;1&quot; ]; then<br>		ip=&quot;127.0.0.1&quot;<br>		log &quot;Reset DDNS address to loopback...&quot;<br>	elif [ &quot;$reset_ip&quot; -eq &quot;2&quot; ]; then<br>		read -p &quot;Please enter an A record IP:\n&quot; ip<br>		log &quot;Got it, now setting DDNS...&quot;<br>	else<br>		if [ $ip_index = &quot;internet&quot; ];then<br>			ip=$(curl -4 ip.sb)<br>		elif [ $ip_index = &quot;local&quot; ];then<br>			if [ &quot;$user&quot; = &quot;root&quot; ];then<br>				ip=$(ifconfig $eth_card | grep &#x27;inet&#x27;| grep -v &#x27;127.0.0.1&#x27; | grep -v &#x27;inet6&#x27;|cut -f2 | awk &#x27;&#123; print $2&#125;&#x27;)<br>			else<br>				ip=$(/sbin/ifconfig $eth_card | grep &#x27;inet&#x27;| grep -v &#x27;127.0.0.1&#x27; | grep -v &#x27;inet6&#x27;|cut -f2 | awk &#x27;&#123; print $2&#125;&#x27;)<br>			fi<br>		else<br>			log &quot;Error IP index, please input the right type&quot;<br>			exit 0<br>		fi<br>	fi<br>else<br>    log &quot;Error DNS type&quot;<br>    exit 0<br>fi<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">SCRIPT START</span><br>log &quot;Check Initiated&quot;<br>log &quot;Your ip is:    $&#123;ip&#125;&quot;<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">åˆ¤æ–­ipæ˜¯å¦å‘ç”Ÿå˜åŒ–</span><br>if [ &quot;$enable_cache&quot; -eq &quot;1&quot; ]; then<br>    if [ -f $ip_file ]; then<br>        old_ip=$(cat $ip_file)<br>        if [ $ip == $old_ip ]; then<br>            log &quot;IP has not changed.&quot;<br>            exit 0<br>        fi<br>    fi<br>fi<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">æ›´æ–°DNSè®°å½•</span><br>update=$(curl --request PATCH \<br>  --url &quot;https://api.cloudflare.com/client/v4/zones/$zone_id/dns_records/$record_id&quot; \<br>  --header &#x27;Content-Type: application/json&#x27; \<br>  --header &quot;Authorization: Bearer $api_key&quot; \<br>  --data &quot;&#123;\&quot;content\&quot;: \&quot;$ip\&quot;, \&quot;proxied\&quot;: $proxied, \&quot;type\&quot;: \&quot;$record_type\&quot;, \&quot;comment\&quot;: \&quot;DDNS\&quot;, \&quot;ttl\&quot;: 1&#125;&quot;)<br><br>echo &quot;$update&quot;<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">è¾“å‡ºDDNSæ›´æ–°æƒ…å†µ</span><br>if [[ $update == *&quot;\&quot;success\&quot;:true&quot;* ]]; then<br>    message=&quot;$api_key -&gt; $ip&quot;<br>    if [ &quot;$enable_cache&quot; -eq &quot;1&quot; ]; then<br>        echo &quot;$message&quot; &gt; $ip_file<br>    fi<br>    log &quot;$message&quot;<br>else<br>    message=&quot;API UPDATE FAILED. DUMPING RESULTS:\n$update&quot;<br>    log &quot;$message&quot;<br>    exit 1<br>fi<br></code></pre></td></tr></table></figure>



<p>è¿™æ˜¯pythonç‰ˆçš„ï¼š</p>
<blockquote>
<p>pythonç‰ˆå…¼ä»»<code>linux</code>å’Œ<code>windows</code>ï¼Œshellç‰ˆé€‚åˆæ€§èƒ½å·®çš„è®¾å¤‡ã€‚</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> datetime<br><span class="hljs-keyword">import</span> platform<br><span class="hljs-keyword">import</span> subprocess<br><span class="hljs-keyword">import</span> re<br><br><span class="hljs-comment"># éœ€è¦å…ˆå®‰è£…ä»¥ä¸‹pipåŒ…æ‰èƒ½è¿è¡Œ:</span><br><span class="hljs-comment"># requests</span><br><br><span class="hljs-comment"># é…ç½®å˜é‡</span><br>zone_id=<span class="hljs-string">&quot;&quot;</span>  <span class="hljs-comment"># cloudFlareé‡ŒåŸŸåçš„zone id</span><br>record_id=<span class="hljs-string">&quot;&quot;</span>   <span class="hljs-comment"># ä½ è¦ä¿®æ”¹çš„äºŒçº§åŸŸåçš„record id,é€šè¿‡getè„šæœ¬è·å–</span><br>api_key=<span class="hljs-string">&quot;&quot;</span> <span class="hljs-comment"># ä½ çš„API key,ç”¨äºä¿®æ”¹dnsè®°å½•çš„key</span><br>domain_main=<span class="hljs-string">&quot;&quot;</span>   <span class="hljs-comment"># ä½ çš„ä¸»åŸŸå, å¦‚google.com</span><br>proxied=<span class="hljs-string">&quot;false&quot;</span>	<span class="hljs-comment"># æ˜¯å¦è¦å¯ç”¨cdnã€‚åˆæ³•å€¼åªæœ‰trueå’Œfalse</span><br>record_type = <span class="hljs-string">&quot;AAAA&quot;</span>  <span class="hljs-comment"># A or AAAA, ipv4 æˆ– ipv6è§£æ</span><br><br>eth_card = <span class="hljs-string">&quot;&quot;</span>  <span class="hljs-comment"># ä½¿ç”¨æœ¬åœ°æ–¹å¼è·å–IPç»‘å®šçš„ç½‘å¡, å¦‚eth0ã€‚æ­¤è®¾ç½®é¡¹åªåœ¨linuxä¸Šç”Ÿæ•ˆ</span><br>ip_index = <span class="hljs-string">&quot;local&quot;</span>  <span class="hljs-comment"># ä½¿ç”¨ &quot;internet&quot; æˆ– &quot;local&quot;, è·å–åœ°å€çš„æ–¹å¼</span><br><br>reset_ip = <span class="hljs-number">0</span> <span class="hljs-comment"># 1ä¸ºå°†ddnsçš„ipæ”¹ä¸ºlocalhostï¼Œ2ä¸ºæ‰‹åŠ¨è¾“å…¥ipï¼Œå…¶ä»–ä»»æ„å€¼ä¸ºä¸æ˜¯</span><br>enable_cache = <span class="hljs-number">0</span>  <span class="hljs-comment"># 1ä¸ºä¿å­˜ç¼“å­˜æ–‡ä»¶ï¼Œå…¶ä»–ä»»æ„å€¼ä¸ºä¸ä¿å­˜ç¼“å­˜æ–‡ä»¶</span><br>skip_connectivity_check = <span class="hljs-number">0</span> <span class="hljs-comment"># 0ä¸ºä¸è·³è¿‡è„šæœ¬æœ€å¼€å§‹è¿è¡Œçš„æ—¶å€™çš„æ£€æŸ¥è¿æ¥</span><br>ip_file = <span class="hljs-string">&quot;ip.txt&quot;</span>  <span class="hljs-comment"># ä¿å­˜åœ°å€ä¿¡æ¯çš„æ–‡ä»¶</span><br>id_file = <span class="hljs-string">&quot;cloudflare.ids&quot;</span><br>log_file = <span class="hljs-string">&quot;cloudflare.log&quot;</span><br><br><br><span class="hljs-comment"># æŒ‰ç…§è¿™ä¸ªæ ¼å¼å¡«å…¥config.txt</span><br>example_config_file = &#123;<br>  <span class="hljs-string">&quot;zone_id&quot;</span>: <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-comment"># cloudFlareé‡ŒåŸŸåçš„zone id</span><br>  <span class="hljs-string">&quot;record_id&quot;</span>: <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-comment"># ä½ è¦ä¿®æ”¹çš„äºŒçº§åŸŸåçš„record id,é€šè¿‡getè„šæœ¬è·å–</span><br>  <span class="hljs-string">&quot;api_key&quot;</span>: <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-comment"># ä½ çš„API key,ç”¨äºä¿®æ”¹dnsè®°å½•çš„key</span><br>  <span class="hljs-string">&quot;domain_main&quot;</span>: <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-comment"># ä½ çš„ä¸»åŸŸå, å¦‚google.com</span><br>  <span class="hljs-string">&quot;proxied&quot;</span>: <span class="hljs-string">&quot;false&quot;</span>, <span class="hljs-comment"># æ˜¯å¦è¦å¯ç”¨cdnã€‚åˆæ³•å€¼åªæœ‰trueå’Œfalse</span><br>  <span class="hljs-string">&quot;record_type&quot;</span>: <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-comment"># A or AAAA, ipv4 æˆ– ipv6è§£æ</span><br>  <span class="hljs-string">&quot;eth_card&quot;</span>: <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-comment"># ä½¿ç”¨æœ¬åœ°æ–¹å¼è·å–IPç»‘å®šçš„ç½‘å¡, å¦‚eth0ã€‚æ­¤è®¾ç½®é¡¹åªåœ¨linuxä¸Šç”Ÿæ•ˆ</span><br>  <span class="hljs-string">&quot;ip_index&quot;</span>: <span class="hljs-string">&quot;local&quot;</span>, <span class="hljs-comment"># ä½¿ç”¨ &quot;internet&quot; æˆ– &quot;local&quot;, è·å–åœ°å€çš„æ–¹å¼ã€‚internalä¸æ”¯æŒè·å–ipv4åœ°å€</span><br>  <span class="hljs-string">&quot;reset_ip&quot;</span>: <span class="hljs-number">0</span>, <span class="hljs-comment"># 1ä¸ºå°†ddnsçš„ipæ”¹ä¸ºlocalhostï¼Œå…¶ä»–ä»»æ„å€¼ä¸ºä¸æ˜¯</span><br>  <span class="hljs-string">&quot;enable_cache&quot;</span>: <span class="hljs-number">0</span>, <span class="hljs-comment"># 1ä¸ºä¿å­˜ç¼“å­˜æ–‡ä»¶ï¼Œå…¶ä»–ä»»æ„å€¼ä¸ºä¸ä¿å­˜ç¼“å­˜æ–‡ä»¶</span><br>  <span class="hljs-string">&quot;skip_connectivity_check&quot;</span>: <span class="hljs-number">0</span>,<span class="hljs-comment"># 0ä¸ºä¸è·³è¿‡è„šæœ¬æœ€å¼€å§‹è¿è¡Œçš„æ—¶å€™çš„æ£€æŸ¥è¿æ¥</span><br>  <span class="hljs-string">&quot;ip_file&quot;</span>: <span class="hljs-string">&quot;ip.txt&quot;</span>, <span class="hljs-comment"># ä¸éœ€è¦å¡«å†™</span><br>  <span class="hljs-string">&quot;id_file&quot;</span>: <span class="hljs-string">&quot;cloudflare.ids&quot;</span>, <span class="hljs-comment"># ä¸éœ€è¦å¡«å†™</span><br>  <span class="hljs-string">&quot;log_file&quot;</span>: <span class="hljs-string">&quot;cloudflare.log&quot;</span> <span class="hljs-comment"># ä¸éœ€è¦å¡«å†™</span><br>&#125;<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">log</span>(<span class="hljs-params">message</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;æ—¥å¿—å‡½æ•°&quot;&quot;&quot;</span><br>    <span class="hljs-keyword">if</span> message:<br>        <span class="hljs-keyword">if</span> enable_cache == <span class="hljs-number">1</span>:<br>            <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(log_file, <span class="hljs-string">&#x27;a&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>                f.write(<span class="hljs-string">f&quot;[<span class="hljs-subst">&#123;datetime.datetime.now()&#125;</span>] - <span class="hljs-subst">&#123;message&#125;</span>\n&quot;</span>)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[<span class="hljs-subst">&#123;datetime.datetime.now()&#125;</span>] - <span class="hljs-subst">&#123;message&#125;</span>&quot;</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">init_value</span>():<br>    <span class="hljs-keyword">global</span> zone_id, record_id, api_key, domain_main, proxied, record_type, eth_card, skip_connectivity_check, ip_index, reset_ip, enable_cache, ip_file, id_file, og_file<br>    config_dict = &#123;&#125;<br>    script_dir = os.path.dirname(os.path.abspath(__file__))<br>    config_path = os.path.join(script_dir, <span class="hljs-string">&quot;config.txt&quot;</span>)<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(config_path, <span class="hljs-string">&#x27;r&#x27;</span>, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>            <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> file:<br>                line = line.strip()<br>                <span class="hljs-keyword">if</span> line <span class="hljs-keyword">and</span> <span class="hljs-string">&#x27;=&#x27;</span> <span class="hljs-keyword">in</span> line:<br>                    key, value = line.split(<span class="hljs-string">&#x27;=&#x27;</span>, <span class="hljs-number">1</span>)<br>                    config_dict[key] = value<br>            common_keys = <span class="hljs-built_in">set</span>(config_dict.keys()) &amp; <span class="hljs-built_in">set</span>(example_config_file.keys())<br>            different_values = &#123;&#125;<br>            <span class="hljs-keyword">for</span> key <span class="hljs-keyword">in</span> common_keys:<br>                <span class="hljs-keyword">if</span> config_dict[key] != example_config_file[key]:<br>                    different_values[key] = (config_dict[key], example_config_file[key])<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(different_values) == <span class="hljs-number">0</span>:<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;è¯·å°†è¯¥é…ç½®æ–‡ä»¶å¡«å†™å®Œæˆ:<span class="hljs-subst">&#123;config_path&#125;</span>&quot;</span>)<br>                sys.exit()<br>            log(<span class="hljs-string">&quot;File config.txt exists.&quot;</span>)<br>            zone_id = config_dict.get(<span class="hljs-string">&#x27;zone_id&#x27;</span>)<br>            record_id = config_dict.get(<span class="hljs-string">&#x27;record_id&#x27;</span>)<br>            api_key = config_dict.get(<span class="hljs-string">&#x27;api_key&#x27;</span>)<br>            domain_main = config_dict.get(<span class="hljs-string">&#x27;domain_main&#x27;</span>)<br>            proxied = config_dict.get(<span class="hljs-string">&#x27;proxied&#x27;</span>)<br>            record_type = config_dict.get(<span class="hljs-string">&#x27;record_type&#x27;</span>)<br>            eth_card = config_dict.get(<span class="hljs-string">&#x27;eth_card&#x27;</span>)<br>            ip_index = config_dict.get(<span class="hljs-string">&#x27;ip_index&#x27;</span>)<br>            reset_ip = <span class="hljs-built_in">int</span>(config_dict.get(<span class="hljs-string">&#x27;reset_ip&#x27;</span>))<br>            enable_cache = <span class="hljs-built_in">int</span>(config_dict.get(<span class="hljs-string">&#x27;enable_cache&#x27;</span>))<br>            skip_connectivity_check = <span class="hljs-built_in">int</span>(config_dict.get(<span class="hljs-string">&#x27;skip_connectivity_check&#x27;</span>))<br>            ip_file = config_dict.get(<span class="hljs-string">&#x27;ip_file&#x27;</span>)<br>            id_file = config_dict.get(<span class="hljs-string">&#x27;id_file&#x27;</span>)<br>            log_file = config_dict.get(<span class="hljs-string">&#x27;log_file&#x27;</span>)<br>    <span class="hljs-keyword">except</span> FileNotFoundError:<br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(config_path, <span class="hljs-string">&#x27;w&#x27;</span>, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>            <span class="hljs-keyword">for</span> key, value <span class="hljs-keyword">in</span> example_config_file.items():<br>                file.write(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;key&#125;</span>=<span class="hljs-subst">&#123;value&#125;</span>\n&#x27;</span>)<br>            <span class="hljs-comment">#json.dump(example_config_file, file, ensure_ascii=False, indent=4)</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;è¯·å°†è¯¥é…ç½®æ–‡ä»¶å¡«å†™å®Œæˆ:<span class="hljs-subst">&#123;config_path&#125;</span>&quot;</span>)<br>        sys.exit()<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_ipv6_address_windows</span>():<br>    <span class="hljs-string">&quot;&quot;&quot;åœ¨Windowsä¸Šè·å–ä¸´æ—¶IPv6åœ°å€&quot;&quot;&quot;</span><br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-comment"># æ‰§è¡Œipconfigå‘½ä»¤å¹¶æ•è·è¾“å‡º</span><br>        output = subprocess.check_output([<span class="hljs-string">&quot;ipconfig&quot;</span>], text=<span class="hljs-literal">True</span>)<br>        <span class="hljs-comment"># ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æŸ¥æ‰¾ä¸´æ—¶IPv6åœ°å€</span><br>        <span class="hljs-keyword">match</span> = re.search(<span class="hljs-string">r&quot;ä¸´æ—¶ IPv6 åœ°å€.*: ([a-fA-F0-9:]+)&quot;</span>, output)<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">match</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">match</span>.group(<span class="hljs-number">1</span>)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Error: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_ipv6_address_linux</span>():<br>    <span class="hljs-string">&quot;&quot;&quot;åœ¨Linuxä¸Šè·å–Global IPv6åœ°å€&quot;&quot;&quot;</span><br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-comment"># æ‰§è¡Œip -6 addr showå‘½ä»¤å¹¶æ•è·è¾“å‡º</span><br>        output = subprocess.check_output([<span class="hljs-string">&quot;ip&quot;</span>, <span class="hljs-string">&quot;-6&quot;</span>, <span class="hljs-string">&quot;addr&quot;</span>, <span class="hljs-string">&quot;show&quot;</span>, eth_card], text=<span class="hljs-literal">True</span>)<br>        <span class="hljs-comment"># ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æŸ¥æ‰¾global scopeçš„IPv6åœ°å€</span><br>        <span class="hljs-keyword">match</span> = re.search(<span class="hljs-string">r&quot;inet6\s+([a-fA-F0-9:]+)/\d+\s+scope global&quot;</span>, output)<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">match</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">match</span>.group(<span class="hljs-number">1</span>)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Error: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_ipv6_platform</span>():<br>    <span class="hljs-keyword">if</span> platform.system() == <span class="hljs-string">&quot;Windows&quot;</span>:<br>        <span class="hljs-keyword">return</span> get_ipv6_address_windows()<br>    <span class="hljs-keyword">elif</span> platform.system() == <span class="hljs-string">&quot;Linux&quot;</span>:<br>        <span class="hljs-keyword">return</span> get_ipv6_address_linux()<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_ip</span>():<br>    <span class="hljs-string">&quot;&quot;&quot;è·å–IPåœ°å€&quot;&quot;&quot;</span><br>    <span class="hljs-keyword">if</span> record_type == <span class="hljs-string">&quot;AAAA&quot;</span>:<br>        <span class="hljs-keyword">if</span> reset_ip == <span class="hljs-number">1</span>:<br>            log(<span class="hljs-string">&quot;Reset DDNS address to loopback...&quot;</span>)<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;::1&quot;</span><br>        <span class="hljs-keyword">elif</span> reset_ip == <span class="hljs-number">2</span>:<br>            ip = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;Please enter an AAAA record IP:\n&quot;</span>)<br>            log(<span class="hljs-string">&quot;Got it, now setting DDNS...&quot;</span>)<br>            <span class="hljs-keyword">return</span> ip<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">if</span> ip_index == <span class="hljs-string">&quot;internet&quot;</span>:<br>                <span class="hljs-keyword">return</span> requests.get(<span class="hljs-string">&#x27;https://api64.ipify.org?format=json&#x27;</span>).json()[<span class="hljs-string">&#x27;ip&#x27;</span>]<br>            <span class="hljs-keyword">elif</span> ip_index == <span class="hljs-string">&quot;local&quot;</span>:<br>                <span class="hljs-keyword">return</span> get_ipv6_platform()<br>                <span class="hljs-keyword">pass</span><br>    <span class="hljs-keyword">elif</span> record_type == <span class="hljs-string">&quot;A&quot;</span>:<br>        <span class="hljs-keyword">if</span> reset_ip == <span class="hljs-number">1</span>:<br>            log(<span class="hljs-string">&quot;Reset DDNS address to loopback...&quot;</span>)<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;127.0.0.1&quot;</span><br>        <span class="hljs-keyword">elif</span> reset_ip == <span class="hljs-number">2</span>:<br>            ip = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;Please enter an A record IP:\n&quot;</span>)<br>            log(<span class="hljs-string">&quot;Got it, now setting DDNS...&quot;</span>)<br>            <span class="hljs-keyword">return</span> ip<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">if</span> ip_index == <span class="hljs-string">&quot;internet&quot;</span>:<br>                <span class="hljs-keyword">return</span> requests.get(<span class="hljs-string">&#x27;https://api.ipify.org?format=json&#x27;</span>).json()[<span class="hljs-string">&#x27;ip&#x27;</span>]<br>            <span class="hljs-keyword">elif</span> ip_index == <span class="hljs-string">&quot;local&quot;</span>:<br>                <span class="hljs-keyword">return</span> <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;è¾“å…¥ä½ çš„ipv4åœ°å€\n&quot;</span>)<br>                <span class="hljs-keyword">pass</span><br>    <span class="hljs-keyword">else</span>:<br>        log(<span class="hljs-string">&quot;Error DNS type&quot;</span>)<br>        exit(<span class="hljs-number">0</span>)<br>        <br><br><span class="hljs-string">&quot;&quot;&quot;æ›´æ–°Cloudflare DNSè®°å½•&quot;&quot;&quot;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">update_cloudflare_dns</span>(<span class="hljs-params">ip</span>):<br>    <span class="hljs-comment"># æ›´æ–°DNSè®°å½•</span><br>    <br>    proxied_tmp = <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">if</span> proxied == <span class="hljs-string">&quot;true&quot;</span>:<br>        proxied_tmp = <span class="hljs-literal">True</span><br>    <br>    headers = &#123;<br>        <span class="hljs-string">&quot;Authorization&quot;</span>: <span class="hljs-string">&quot;Bearer &quot;</span> + api_key,<br>        <span class="hljs-string">&quot;Content-Type&quot;</span>: <span class="hljs-string">&quot;application/json&quot;</span>,<br>    &#125;<br>    data = &#123;<br>        <span class="hljs-string">&quot;content&quot;</span>: ip,<br>        <span class="hljs-string">&quot;name&quot;</span>: domain_main,<br>        <span class="hljs-string">&quot;proxied&quot;</span>: proxied_tmp,<br>        <span class="hljs-string">&quot;type&quot;</span>: record_type,<br>        <span class="hljs-string">&quot;comment&quot;</span>: <span class="hljs-string">&quot;DDNS&quot;</span>,<br>        <span class="hljs-string">&quot;ttl&quot;</span>: <span class="hljs-string">&quot;1&quot;</span><br>    &#125;<br>    update_response = requests.patch(<span class="hljs-string">&quot;https://api.cloudflare.com/client/v4/zones/&quot;</span> + zone_id + <span class="hljs-string">&quot;/dns_records/&quot;</span> + record_id, headers=headers, json=data)<br>    <span class="hljs-keyword">return</span> update_response.json()<br><br><br><br><span class="hljs-comment"># ä¸»é€»è¾‘</span><br>log(<span class="hljs-string">&quot;Init config&quot;</span>)<br>init_value()<br>log(<span class="hljs-string">&quot;Starting DDNS&quot;</span>)<br><span class="hljs-keyword">if</span> skip_connectivity_check == <span class="hljs-number">0</span>:<br>    <span class="hljs-comment"># æ£€æŸ¥è¿æ¥æ€§</span><br>    log(<span class="hljs-string">&quot;Checking connectivity to cloudflare&quot;</span>)<br>    <span class="hljs-keyword">try</span>:<br>        response = requests.get(<span class="hljs-string">&quot;https://api.cloudflare.com&quot;</span>, timeout=<span class="hljs-number">30</span>)<br>        <span class="hljs-comment"># å¦‚æœè¯·æ±‚æˆåŠŸï¼ŒçŠ¶æ€ç ä¸º200</span><br>        <span class="hljs-keyword">if</span> response.ok:<br>            log(<span class="hljs-string">&quot;Successfully connected to https://api.cloudflare.com&quot;</span>)<br>        <span class="hljs-keyword">else</span>:<br>            log(<span class="hljs-string">&quot;Connected to https://api.cloudflare.com but received a non-success status code:&quot;</span>, response.status_code)<br>    <span class="hljs-keyword">except</span> requests.exceptions.RequestException <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-comment"># å¤„ç†è¿æ¥é”™è¯¯</span><br>        log(<span class="hljs-string">&quot;Error connecting to https://api.cloudflare.com&quot;</span>)<br>        log(e)<br>        sys.exit()<br>    <span class="hljs-keyword">except</span> requests.exceptions.Timeout:<br>        <span class="hljs-comment"># å¤„ç†è¿æ¥è¶…æ—¶</span><br>        log(<span class="hljs-string">&quot;Timeout connecting to https://api.cloudflare.com&quot;</span>)<br>        log(e)<br>        sys.exit()<br>    log(<span class="hljs-string">&quot;Check Initiated&quot;</span>)<br><span class="hljs-keyword">else</span>:<br>    log(<span class="hljs-string">&quot;Skipping check connectivity to Cloudflare&quot;</span>)<br><br><span class="hljs-comment"># è·å–IPåœ°å€</span><br>ip = get_ip()<br>log(<span class="hljs-string">f&quot;Your ip is:    <span class="hljs-subst">&#123;ip&#125;</span>&quot;</span>)<br><br><span class="hljs-comment"># åˆ¤æ–­IPæ˜¯å¦å‘ç”Ÿå˜åŒ–</span><br>old_ip = <span class="hljs-literal">None</span><br><span class="hljs-keyword">if</span> enable_cache == <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> os.path.exists(ip_file):<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(ip_file) <span class="hljs-keyword">as</span> f:<br>        old_ip = f.read().strip()<br><span class="hljs-keyword">if</span> ip == old_ip:<br>    <span class="hljs-keyword">if</span> ip == <span class="hljs-literal">None</span>:<br>        log(<span class="hljs-string">&quot;Check your Internet connection.&quot;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        log(<span class="hljs-string">&quot;IP has not changed.&quot;</span>)<br>    exit(<span class="hljs-number">0</span>)<br><br><span class="hljs-comment"># æ›´æ–°DNSè®°å½•</span><br>update_result = update_cloudflare_dns(ip)<br><span class="hljs-keyword">if</span> update_result[<span class="hljs-string">&#x27;success&#x27;</span>]:<br>    message = <span class="hljs-string">f&quot;Now <span class="hljs-subst">&#123;record_id&#125;</span> -&gt; <span class="hljs-subst">&#123;ip&#125;</span>&quot;</span><br>    <span class="hljs-keyword">if</span> enable_cache == <span class="hljs-number">1</span>:<br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(ip_file, <span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>            f.write(message)<br>    log(message)<br><span class="hljs-keyword">else</span>:<br>    message = <span class="hljs-string">f&quot;API UPDATE FAILED. DUMPING RESULTS:\n<span class="hljs-subst">&#123;update_result&#125;</span>&quot;</span><br>    log(message)<br>    exit(<span class="hljs-number">1</span>)<br><br></code></pre></td></tr></table></figure>
                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/Linux/" class="category-chain-item">Linux</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>æŠ˜è…¾ä¸€ç•ªCloudFlare DDNS</div>
      <div>http://blog.coolenoch.ink/2024/03/02/10æŠ˜è…¾ä¸€ç•ªCloudFlare DDNS-240302/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>ä½œè€…</div>
          <div>CoolestEnoch</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>å‘å¸ƒäº</div>
          <div>2024å¹´3æœˆ2æ—¥</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>è®¸å¯åè®®</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - ç½²å">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2024/03/15/11%E4%BB%8EKDE%E5%88%B0Gnome%E7%9A%84%E6%97%85%E7%A8%8B-240315/" title="ä»KDEåˆ°Gnomeçš„æ—…ç¨‹">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">ä»KDEåˆ°Gnomeçš„æ—…ç¨‹</span>
                        <span class="visible-mobile">ä¸Šä¸€ç¯‡</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2024/03/01/9%E8%AE%B0%E6%9C%AC%E7%A7%91%E6%AF%95%E4%B8%9A%E5%AE%9E%E4%B9%A0%E7%9A%84%E4%BB%A3%E7%A0%81-240301/" title="è®°æœ¬ç§‘æ¯•ä¸šå®ä¹ çš„ä»£ç ">
                        <span class="hidden-mobile">è®°æœ¬ç§‘æ¯•ä¸šå®ä¹ çš„ä»£ç </span>
                        <span class="visible-mobile">ä¸‹ä¸€ç¯‡</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>ç›®å½•</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">æœç´¢</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">å…³é”®è¯</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>




  
<script src="/js/effect/GoTop/jquery.min.js"></script>
<script src="/js/effect/lib/jquery-1.9.1.min.js"></script>
<script src="/js/effect/lib/jquery-3.6.0.min.js"></script>
<script src="/js/effect/clickeffect.js"></script>
<script src="/js/effect/clickWord.js"></script>
<script src="/js/effect/emojiCursor.js"></script>
<script src="/js/effect/sakura-less.js"></script>
<script src="/js/effect/sakana@1.0.8.js"></script>
<script src="/js/effect/cuteTitle.js"></script>
<script src="/js/effect/GoTop/szgotop.js"></script>
<script src="/js/effect/Netease.js"></script>



<!-- ä¸»é¢˜çš„å¯åŠ¨é¡¹ï¼Œå°†å®ƒä¿æŒåœ¨æœ€åº•éƒ¨ -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">åšå®¢åœ¨å…è®¸ JavaScript è¿è¡Œçš„ç¯å¢ƒä¸‹æµè§ˆæ•ˆæœæ›´ä½³</div>
  </noscript>
</body>
</html>
